System.register(["./index-68ccac70.js","./sprite-renderer-e5daf04e.js","./sprite-e4e3e9a1.js","./director-56fe9b8d.js","./find-222dc7da.js","./pipeline-state-manager-8f16c5a7.js","./node-event-40319828.js","./xr-event-handle-fbaa8308.js","./deprecated-37e42d8f.js","./touch-685512cb.js","./camera-component-9188fe5a.js","./buffer-barrier-d1733967.js","./renderer-7bc9d919.js","./create-mesh-1be8f092.js","./mesh-97b1b18c.js","./deprecated-2e80a469.js","./model-renderer-8b84c274.js"],(function(t){"use strict";var e,i,n,o,r,s,a,h,c,l,_,u,d,p,g,f,y,T,v,m,C,S,E,L,A,O,b,D,I,R,x,w,P,N,B,H,M,z,k,V,F,U,G,W,j,Z,X,Y,K,q,Q,J,$,tt,et,it,nt,ot,rt,st,at,ht,ct,lt,_t,ut,dt,pt,gt,ft,yt,Tt,vt,mt,Ct,St,Et,Lt;return{setters:[function(t){e=t.B,i=t.ab,n=t.bD,o=t.bF,r=t.bA,s=t.L,a=t.o,h=t.bx,c=t.b$,l=t.bE,_=t.l,u=t.ct,d=t.cD,p=t.bg,g=t.aa,f=t.b_,y=t.t,T=t.cF,v=t.aM,m=t.bH,C=t.bL,S=t.cl,E=t.aO,L=t.cG,A=t.cH,O=t.cI,b=t.S,D=t.w,I=t.V,R=t.K,x=t.i,w=t.c,P=t.f,N=t.ce,B=t.c2,H=t.d,M=t.be,z=t.bN,k=t.I,V=t.F,F=t.bJ,U=t.as,G=t.aj,W=t.cq,j=t.ah,Z=t.ai},function(e){X=e.b,Y=e.c,K=e.a,q=e.h,Q=e.V,t({ResolutionPolicy:e.r,View:e.V,view:e.h})},function(t){J=t.a,$=t.B,tt=t.b,et=t.V},function(t){it=t.a3,nt=t.a2,ot=t.a9,rt=t.aa},function(t){st=t.T,at=t.N,ht=t.w,ct=t.a2,lt=t.a3},function(){},function(t){_t=t.N,ut=t.E,dt=t.C},function(t){pt=t.X,gt=t.a,ft=t.D},function(t){yt=t.g},function(t){Tt=t.K,vt=t.d,mt=t.S,Ct=t.E,St=t.e,Et=t.f},function(t){Lt=t.C},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var At,Ot,bt,Dt,It,Rt,xt,wt,Pt,Nt,Bt,Ht,Mt,zt,kt,Vt,Ft,Ut,Gt,Wt,jt,Zt,Xt,Yt,Kt,qt,Qt,Jt,$t,te,ee=new e;!function(t){t[t.NONE=0]="NONE",t[t.COLOR=1]="COLOR",t[t.SPRITE=2]="SPRITE",t[t.SCALE=3]="SCALE"}(Jt||(Jt={})),i(Jt),function(t){t.NORMAL="normal",t.HOVER="hover",t.PRESSED="pressed",t.DISABLED="disabled"}($t||($t={})),function(t){t.CLICK="click"}(te||(te={}));var ie=(At=n("cc.Button"),Ot=u(110),bt=d(Y),Dt=o(at),It=o(Jt),Rt=o(K),xt=o(K),wt=o(K),Pt=o(K),Nt=o([ut]),At(Bt=Ot(Bt=bt(((Qt=function(t){function i(){for(var i,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(i=t.call.apply(t,[this].concat(o))||this).clickEvents=Mt&&Mt(),i._interactable=zt&&zt(),i._transition=kt&&kt(),i._normalColor=Vt&&Vt(),i._hoverColor=Ft&&Ft(),i._pressedColor=Ut&&Ut(),i._disabledColor=Gt&&Gt(),i._normalSprite=Wt&&Wt(),i._hoverSprite=jt&&jt(),i._pressedSprite=Zt&&Zt(),i._disabledSprite=Xt&&Xt(),i._duration=Yt&&Yt(),i._zoomScale=Kt&&Kt(),i._target=qt&&qt(),i._pressed=!1,i._hovered=!1,i._fromColor=new e,i._toColor=new e,i._time=0,i._transitionFinished=!0,i._fromScale=new a,i._toScale=new a,i._originalScale=null,i._sprite=null,i._targetScale=new a,i}r(i,t);var n=i.prototype;return n.__preload=function(){this.target||(this.target=this.node);var t=this.node.getComponent(J);t&&(this._normalSprite=t.spriteFrame),this._applyTarget(),this._resetState()},n.onEnable=function(){this._registerNodeEvent()},n.onDisable=function(){this._resetState(),this._unregisterNodeEvent()},n.onDestroy=function(){this.target.isValid&&this._unregisterTargetEvent(this.target)},n.update=function(t){var i=this.target;if(!this._transitionFinished&&i&&(this._transition===Jt.COLOR||this._transition===Jt.SCALE)){this._time+=t;var n=1;if(this._duration>0&&(n=this._time/this._duration),n>=1&&(n=1),this._transition===Jt.COLOR){var o=i._uiProps.uiComp;e.lerp(ee,this._fromColor,this._toColor,n),o&&(o.color=ee)}else this.transition===Jt.SCALE&&(i.getScale(this._targetScale),this._targetScale.x=s(this._fromScale.x,this._toScale.x,n),this._targetScale.y=s(this._fromScale.y,this._toScale.y,n),i.setScale(this._targetScale));1===n&&(this._transitionFinished=!0)}},n._resizeNodeToTargetNode=function(){this.target&&this.target._uiProps.uiTransformComp},n._resetState=function(){this._pressed=!1,this._hovered=!1;var t=this.target;if(t){var e=this._transition;if(e===Jt.COLOR&&this._interactable){var i=t.getComponent(X);i&&(i.color=this._normalColor)}else e===Jt.SCALE&&this._originalScale&&t.setScale(this._originalScale);this._transitionFinished=!0}},n._registerNodeEvent=function(){this.node.on(_t.TOUCH_START,this._onTouchBegan,this),this.node.on(_t.TOUCH_MOVE,this._onTouchMove,this),this.node.on(_t.TOUCH_END,this._onTouchEnded,this),this.node.on(_t.TOUCH_CANCEL,this._onTouchCancel,this),this.node.on(_t.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.on(_t.MOUSE_LEAVE,this._onMouseMoveOut,this),this.node.on(pt.XRUI_HOVER_ENTERED,this._xrHoverEnter,this),this.node.on(pt.XRUI_HOVER_EXITED,this._xrHoverExit,this),this.node.on(pt.XRUI_CLICK,this._xrClick,this),this.node.on(pt.XRUI_UNCLICK,this._xrUnClick,this)},n._registerTargetEvent=function(t){t.on(_t.TRANSFORM_CHANGED,this._onTargetTransformChanged,this)},n._unregisterNodeEvent=function(){this.node.off(_t.TOUCH_START,this._onTouchBegan,this),this.node.off(_t.TOUCH_MOVE,this._onTouchMove,this),this.node.off(_t.TOUCH_END,this._onTouchEnded,this),this.node.off(_t.TOUCH_CANCEL,this._onTouchCancel,this),this.node.off(_t.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.off(_t.MOUSE_LEAVE,this._onMouseMoveOut,this),this.node.off(pt.XRUI_HOVER_ENTERED,this._xrHoverEnter,this),this.node.off(pt.XRUI_HOVER_EXITED,this._xrHoverExit,this),this.node.off(pt.XRUI_CLICK,this._xrClick,this),this.node.off(pt.XRUI_UNCLICK,this._xrUnClick,this)},n._unregisterTargetEvent=function(t){t.off(_t.TRANSFORM_CHANGED)},n._getTargetSprite=function(t){var e=null;return t&&(e=t.getComponent(J)),e},n._applyTarget=function(){this.target&&(this._sprite=this._getTargetSprite(this.target),this._originalScale||(this._originalScale=new a),a.copy(this._originalScale,this.target.getScale()),this._registerTargetEvent(this.target))},n._onTargetSpriteFrameChanged=function(t){this._transition===Jt.SPRITE&&this._setCurrentStateSpriteFrame(t.spriteFrame)},n._setCurrentStateSpriteFrame=function(t){if(t)switch(this._getButtonState()){case $t.NORMAL:this._normalSprite=t;break;case $t.HOVER:this._hoverSprite=t;break;case $t.PRESSED:this._pressedSprite=t;break;case $t.DISABLED:this._disabledSprite=t}},n._onTargetColorChanged=function(t){this._transition===Jt.COLOR&&this._setCurrentStateColor(t)},n._setCurrentStateColor=function(t){switch(this._getButtonState()){case $t.NORMAL:this._normalColor=t;break;case $t.HOVER:this._hoverColor=t;break;case $t.PRESSED:this._pressedColor=t;break;case $t.DISABLED:this._disabledColor=t}},n._onTargetTransformChanged=function(t){t&st.SCALE&&this._originalScale&&this._transition===Jt.SCALE&&this._transitionFinished&&a.copy(this._originalScale,this.target.getScale())},n._onTouchBegan=function(t){this._interactable&&this.enabledInHierarchy&&(this._pressed=!0,this._updateState(),t&&(t.propagationStopped=!0))},n._onTouchMove=function(t){if(this._interactable&&this.enabledInHierarchy&&this._pressed&&t){var e=t.touch;if(e){var i,n=this.node._uiProps.uiTransformComp.hitTest(e.getLocation(),t.windowId);this._transition===Jt.SCALE&&this.target&&this._originalScale?n?(a.copy(this._fromScale,this._originalScale),a.multiplyScalar(this._toScale,this._originalScale,this._zoomScale),this._transitionFinished=!1):(this._time=0,this._transitionFinished=!0,this.target.setScale(this._originalScale)):(i=n?$t.PRESSED:$t.NORMAL,this._applyTransition(i)),t&&(t.propagationStopped=!0)}}},n._onTouchEnded=function(t){this._interactable&&this.enabledInHierarchy&&(this._pressed&&(ut.emitEvents(this.clickEvents,t),this.node.emit(te.CLICK,this)),this._pressed=!1,this._updateState(),t&&(t.propagationStopped=!0))},n._onTouchCancel=function(){this._interactable&&this.enabledInHierarchy&&(this._pressed=!1,this._updateState())},n._onMouseMoveIn=function(){!this._pressed&&this.interactable&&this.enabledInHierarchy&&(this._transition!==Jt.SPRITE||this._hoverSprite)&&(this._hovered||(this._hovered=!0,this._updateState()))},n._onMouseMoveOut=function(){this._hovered&&(this._hovered=!1,this._updateState())},n._updateState=function(){var t=this._getButtonState();this._applyTransition(t)},n._getButtonState=function(){var t=$t.NORMAL;return this._interactable?this._pressed?t=$t.PRESSED:this._hovered&&(t=$t.HOVER):t=$t.DISABLED,t.toString()},n._updateColorTransition=function(t){var e,i=this[t+"Color"],n=null===(e=this.target)||void 0===e?void 0:e.getComponent(X);n&&(t===$t.DISABLED?n.color=i:(this._fromColor=n.color.clone(),this._toColor=i,this._time=0,this._transitionFinished=!1))},n._updateSpriteTransition=function(t){var e=this[t+"Sprite"];this._sprite&&e&&(this._sprite.spriteFrame=e)},n._updateScaleTransition=function(t){this._interactable&&(t===$t.PRESSED?this._zoomUp():this._zoomBack())},n._zoomUp=function(){this._originalScale&&(a.copy(this._fromScale,this._originalScale),a.multiplyScalar(this._toScale,this._originalScale,this._zoomScale),this._time=0,this._transitionFinished=!1)},n._zoomBack=function(){this.target&&this._originalScale&&(a.copy(this._fromScale,this.target.getScale()),a.copy(this._toScale,this._originalScale),this._time=0,this._transitionFinished=!1)},n._applyTransition=function(t){var e=this._transition;e===Jt.COLOR?this._updateColorTransition(t):e===Jt.SPRITE?this._updateSpriteTransition(t):e===Jt.SCALE&&this._updateScaleTransition(t)},n._xrHoverEnter=function(){this._onMouseMoveIn(),this._updateState()},n._xrHoverExit=function(){this._onMouseMoveOut(),this._pressed&&(this._pressed=!1,this._updateState())},n._xrClick=function(){this._interactable&&this.enabledInHierarchy&&(this._pressed=!0,this._updateState())},n._xrUnClick=function(){this._interactable&&this.enabledInHierarchy&&(this._pressed&&(ut.emitEvents(this.clickEvents,this),this.node.emit(te.CLICK,this)),this._pressed=!1,this._updateState())},h(i,[{key:"target",get:function(){return this._target||this.node},set:function(t){this._target!==t&&(this._target&&this._unregisterTargetEvent(this._target),this._target=t,this._applyTarget())}},{key:"interactable",get:function(){return this._interactable},set:function(t){this._interactable!==t&&(this._interactable=t,this._updateState(),this._interactable||this._resetState())}},{key:"_resizeToTarget",set:function(t){t&&this._resizeNodeToTargetNode()}},{key:"transition",get:function(){return this._transition},set:function(t){this._transition!==t&&(this._transition===Jt.COLOR?this._updateColorTransition($t.NORMAL):this._transition===Jt.SPRITE&&this._updateSpriteTransition($t.NORMAL),this._transition=t,this._updateState())}},{key:"normalColor",get:function(){return this._normalColor},set:function(t){this._normalColor!==t&&(this._normalColor.set(t),this._updateState())}},{key:"pressedColor",get:function(){return this._pressedColor},set:function(t){this._pressedColor!==t&&this._pressedColor.set(t)}},{key:"hoverColor",get:function(){return this._hoverColor},set:function(t){this._hoverColor!==t&&this._hoverColor.set(t)}},{key:"disabledColor",get:function(){return this._disabledColor},set:function(t){this._disabledColor!==t&&(this._disabledColor.set(t),this._updateState())}},{key:"duration",get:function(){return this._duration},set:function(t){this._duration!==t&&(this._duration=t)}},{key:"zoomScale",get:function(){return this._zoomScale},set:function(t){this._zoomScale!==t&&(this._zoomScale=t)}},{key:"normalSprite",get:function(){return this._normalSprite},set:function(t){if(this._normalSprite!==t){this._normalSprite=t;var e=this.node.getComponent(J);e&&(e.spriteFrame=t),this._updateState()}}},{key:"pressedSprite",get:function(){return this._pressedSprite},set:function(t){this._pressedSprite!==t&&(this._pressedSprite=t,this._updateState())}},{key:"hoverSprite",get:function(){return this._hoverSprite},set:function(t){this._hoverSprite!==t&&(this._hoverSprite=t,this._updateState())}},{key:"disabledSprite",get:function(){return this._disabledSprite},set:function(t){this._disabledSprite!==t&&(this._disabledSprite=t,this._updateState())}}]),i}(dt)).Transition=Jt,Qt.EventType=te,c((Ht=Qt).prototype,"target",[Dt],Object.getOwnPropertyDescriptor(Ht.prototype,"target"),Ht.prototype),c(Ht.prototype,"transition",[It],Object.getOwnPropertyDescriptor(Ht.prototype,"transition"),Ht.prototype),c(Ht.prototype,"normalSprite",[Rt],Object.getOwnPropertyDescriptor(Ht.prototype,"normalSprite"),Ht.prototype),c(Ht.prototype,"pressedSprite",[xt],Object.getOwnPropertyDescriptor(Ht.prototype,"pressedSprite"),Ht.prototype),c(Ht.prototype,"hoverSprite",[wt],Object.getOwnPropertyDescriptor(Ht.prototype,"hoverSprite"),Ht.prototype),c(Ht.prototype,"disabledSprite",[Pt],Object.getOwnPropertyDescriptor(Ht.prototype,"disabledSprite"),Ht.prototype),Mt=l(Ht.prototype,"clickEvents",[Nt,p],(function(){return[]})),zt=l(Ht.prototype,"_interactable",[p],(function(){return!0})),kt=l(Ht.prototype,"_transition",[p],(function(){return Jt.NONE})),Vt=l(Ht.prototype,"_normalColor",[p],(function(){return e.WHITE.clone()})),Ft=l(Ht.prototype,"_hoverColor",[p],(function(){return new e(211,211,211,255)})),Ut=l(Ht.prototype,"_pressedColor",[p],(function(){return e.WHITE.clone()})),Gt=l(Ht.prototype,"_disabledColor",[p],(function(){return new e(124,124,124,255)})),Wt=l(Ht.prototype,"_normalSprite",[p],(function(){return null})),jt=l(Ht.prototype,"_hoverSprite",[p],(function(){return null})),Zt=l(Ht.prototype,"_pressedSprite",[p],(function(){return null})),Xt=l(Ht.prototype,"_disabledSprite",[p],(function(){return null})),Yt=l(Ht.prototype,"_duration",[p],(function(){return.1})),Kt=l(Ht.prototype,"_zoomScale",[p],(function(){return 1.2})),qt=l(Ht.prototype,"_target",[p],(function(){return null})),Bt=Ht))||Bt)||Bt)||Bt);t({Button:ie,ButtonComponent:ie}),_.Button=ie;var ne,oe,re,se=function(){function t(){}return t.add=function(t){var e=this._tabIndexList;-1===e.indexOf(t)&&e.push(t)},t.remove=function(t){var e=this._tabIndexList,i=e.indexOf(t);-1!==i&&e.splice(i,1)},t.resort=function(){this._tabIndexList.sort((function(t,e){return t._delegate.tabIndex-e._delegate.tabIndex}))},t.next=function(t){var e=this._tabIndexList,i=e.indexOf(t);if(t.setFocus(!1),-1!==i){var n=e[i+1];n&&n._delegate.tabIndex>=0&&n.setFocus(!0)}},t}();se._tabIndexList=[],function(t){t[t.DEFAULT=0]="DEFAULT",t[t.DONE=1]="DONE",t[t.SEND=2]="SEND",t[t.SEARCH=3]="SEARCH",t[t.GO=4]="GO",t[t.NEXT=5]="NEXT"}(ne||(ne={})),g(ne),function(t){t[t.ANY=0]="ANY",t[t.EMAIL_ADDR=1]="EMAIL_ADDR",t[t.NUMERIC=2]="NUMERIC",t[t.PHONE_NUMBER=3]="PHONE_NUMBER",t[t.URL=4]="URL",t[t.DECIMAL=5]="DECIMAL",t[t.SINGLE_LINE=6]="SINGLE_LINE"}(oe||(oe={})),g(oe),function(t){t[t.PASSWORD=0]="PASSWORD",t[t.SENSITIVE=1]="SENSITIVE",t[t.INITIAL_CAPS_WORD=2]="INITIAL_CAPS_WORD",t[t.INITIAL_CAPS_SENTENCE=3]="INITIAL_CAPS_SENTENCE",t[t.INITIAL_CAPS_ALL_CHARACTERS=4]="INITIAL_CAPS_ALL_CHARACTERS",t[t.DEFAULT=5]="DEFAULT"}(re||(re={})),g(re);var ae,he,ce,le,_e,ue,de,pe,ge,fe,ye,Te,ve,me,Ce,Se,Ee,Le,Ae,Oe,be,De,Ie,Re,xe,we,Pe,Ne,Be,He,Me=function(){function t(){this._editing=!1,this._delegate=null}var e=t.prototype;return e.init=function(){},e.onEnable=function(){},e.update=function(){},e.onDisable=function(){this._editing&&this.endEditing()},e.clear=function(){this._delegate=null},e.setTabIndex=function(){},e.setSize=function(){},e.setFocus=function(t){t?this.beginEditing():this.endEditing()},e.isFocused=function(){return this._editing},e.beginEditing=function(){},e.endEditing=function(){},t}(),ze=f.document,ke=new y,Ve=new y,Fe=new a,Ue=null,Ge=0,We=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this)._delegate=null,e._inputMode=-1,e._inputFlag=-1,e._returnType=-1,e.__eventListeners={},e.__autoResize=!1,e.__orientationChanged=void 0,e._edTxt=null,e._isTextArea=!1,e._textLabelFont=null,e._textLabelFontSize=null,e._textLabelFontColor=null,e._textLabelAlign=null,e._placeholderLabelFont=null,e._placeholderLabelFontSize=null,e._placeholderLabelFontColor=null,e._placeholderLabelAlign=null,e._placeholderLineHeight=null,e._placeholderStyleSheet=null,e._domId="EditBoxId_"+ ++Ge,e}r(e,t);var i=e.prototype;return i.init=function(t){t&&(this._delegate=t,t.inputMode===oe.ANY?this._createTextArea():this._createInput(),se.add(this),this.setTabIndex(t.tabIndex),this._initStyleSheet(),this._registerEventListeners(),this._addDomToGameContainer())},i.clear=function(){this._removeEventListeners(),this._removeDomFromGameContainer(),se.remove(this),Ue===this&&(Ue=null),this._delegate=null},i.update=function(){this._updateMatrix()},i.setTabIndex=function(t){this._edTxt.tabIndex=t,se.resort()},i.setSize=function(t,e){var i=this._edTxt;i&&(i.style.width=t+"px",i.style.height=e+"px")},i.beginEditing=function(){Ue&&Ue!==this&&Ue.setFocus(!1),this._editing=!0,Ue=this,this._delegate._editBoxEditingDidBegan(),this._showDom(),this._edTxt.focus()},i.endEditing=function(){this._edTxt.blur()},i._createInput=function(){this._isTextArea=!1,this._edTxt=ze.createElement("input")},i._createTextArea=function(){this._isTextArea=!0,this._edTxt=ze.createElement("textarea")},i._addDomToGameContainer=function(){yt.container&&this._edTxt&&(yt.container.appendChild(this._edTxt),ze.head.appendChild(this._placeholderStyleSheet))},i._removeDomFromGameContainer=function(){T(yt.container,this._edTxt)&&this._edTxt&&yt.container.removeChild(this._edTxt),T(ze.head,this._placeholderStyleSheet)&&ze.head.removeChild(this._placeholderStyleSheet),this._edTxt=null,this._placeholderStyleSheet=null},i._showDom=function(){this._updateMaxLength(),this._updateInputType(),this._updateStyleSheet(),this._edTxt&&this._delegate&&(this._edTxt.style.display="",this._delegate._hideLabels()),v.isMobile&&this._showDomOnMobile()},i._hideDom=function(){var t=this._edTxt;t&&this._delegate&&(t.style.display="none",this._delegate._showLabels()),v.isMobile&&this._hideDomOnMobile()},i._showDomOnMobile=function(){v.os!==m.ANDROID&&v.os!==m.OHOS||(C.handleResizeEvent=!1,this._adjustWindowScroll())},i._hideDomOnMobile=function(){v.os!==m.ANDROID&&v.os!==m.OHOS||(C.handleResizeEvent=!0),this._scrollBackWindow()},i._adjustWindowScroll=function(){var t=this;setTimeout((function(){f.scrollY<40&&t._edTxt.scrollIntoView({block:"start",inline:"nearest",behavior:"smooth"})}),400)},i._scrollBackWindow=function(){setTimeout((function(){v.browserType!==S.WECHAT||v.os!==m.IOS?f.scrollTo(0,0):f.top&&f.top.scrollTo(0,0)}),400)},i._updateMatrix=function(){if(this._edTxt){var t=this._delegate.node,e=q.getScaleX(),i=q.getScaleY(),n=q.getViewportRect(),o=C.devicePixelRatio;t.getWorldMatrix(ke);var r=t._uiProps.uiTransformComp;if(r&&a.set(Fe,-r.anchorX*r.width,-r.anchorY*r.height,Fe.z),y.transform(ke,ke,Fe),t._uiProps.uiTransformComp){var s=it.root.batcher2D.getFirstRenderCamera(t);if(s){s.node.getWorldRT(Ve);var h=Ve.m12,c=Ve.m13,l=E.center;Ve.m12=l.x-(Ve.m00*h+Ve.m04*c),Ve.m13=l.y-(Ve.m01*h+Ve.m05*c),y.multiply(Ve,Ve,ke),e/=o,i/=o;var _=yt.container,u=Ve.m00*e,d=ke.m01,p=ke.m04,g=Ve.m05*i,f=parseInt(_&&_.style.paddingLeft||"0");f+=n.x/o;var T=parseInt(_&&_.style.paddingBottom||"0");T+=n.y/o;var v="matrix("+u+","+-d+","+-p+","+g+","+(Ve.m12*e+f)+","+-(Ve.m13*i+T)+")";this._edTxt.style.transform=v,this._edTxt.style["-webkit-transform"]=v,this._edTxt.style["transform-origin"]="0px 100% 0px",this._edTxt.style["-webkit-transform-origin"]="0px 100% 0px"}}}},i._updateInputType=function(){var t=this._delegate,e=t.inputMode,i=t.inputFlag,n=t.returnType,o=this._edTxt;if(this._inputMode!==e||this._inputFlag!==i||this._returnType!==n){if(this._inputMode=e,this._inputFlag=i,this._returnType=n,this._isTextArea){var r="none";return i===re.INITIAL_CAPS_ALL_CHARACTERS?r="uppercase":i===re.INITIAL_CAPS_WORD&&(r="capitalize"),void(o.style.textTransform=r)}if(o=o,i===re.PASSWORD)return o.type="password",void(o.style.textTransform="none");var s=o.type;e===oe.EMAIL_ADDR?s="email":e===oe.NUMERIC||e===oe.DECIMAL?s="number":e===oe.PHONE_NUMBER?(s="number",o.pattern="[0-9]*",o.addEventListener("wheel",(function(){return!1}))):e===oe.URL?s="url":(s="text",n===ne.SEARCH&&(s="search")),o.type=s;var a="none";i===re.INITIAL_CAPS_ALL_CHARACTERS?a="uppercase":i===re.INITIAL_CAPS_WORD&&(a="capitalize"),o.style.textTransform=a}},i._updateMaxLength=function(){var t=this._delegate.maxLength;t<0&&(t=65535),this._edTxt.maxLength=t},i._initStyleSheet=function(){if(this._edTxt){var t=this._edTxt;t.style.color="#000000",t.style.border="0px",t.style.background="transparent",t.style.width="100%",t.style.height="100%",t.style.outline="medium",t.style.padding="0",t.style.textTransform="none",t.style.display="none",t.style.position="absolute",t.style.bottom="0px",t.style.left="2px",t.className="cocosEditBox",t.style.fontFamily="Arial",t.id=this._domId,this._isTextArea?(t.style.resize="none",t.style.overflowY="scroll"):((t=t).type="text",t.style["-moz-appearance"]="textfield"),this._placeholderStyleSheet=ze.createElement("style")}},i._updateStyleSheet=function(){var t=this._delegate,e=this._edTxt;e&&t&&(e.value=t.string,this._updateTextLabel(t.textLabel))},i._updateTextLabel=function(t){if(t){var e=t.font;e=!e||e instanceof $?t.fontFamily:e._fontFamily;var i=t.fontSize*t.node.scale.y;if((this._textLabelFont!==e||this._textLabelFontSize!==i||this._textLabelFontColor!==t.fontColor||this._textLabelAlign!==t.horizontalAlign)&&(this._textLabelFont=e,this._textLabelFontSize=i,this._textLabelFontColor=t.fontColor,this._textLabelAlign=t.horizontalAlign,this._edTxt)){var n=this._edTxt;switch(n.style.fontSize=i+"px",n.style.color=t.color.toCSS(),n.style.fontFamily=e,t.horizontalAlign){case tt.HorizontalAlign.LEFT:n.style.textAlign="left";break;case tt.HorizontalAlign.CENTER:n.style.textAlign="center";break;case tt.HorizontalAlign.RIGHT:n.style.textAlign="right"}}}},i._updatePlaceholderLabel=function(t){if(t){var e=t.font;e=!e||e instanceof $?t.fontFamily:t.font._fontFamily;var i=t.fontSize*t.node.scale.y;if(this._placeholderLabelFont!==e||this._placeholderLabelFontSize!==i||this._placeholderLabelFontColor!==t.fontColor||this._placeholderLabelAlign!==t.horizontalAlign||this._placeholderLineHeight!==t.fontSize){this._placeholderLabelFont=e,this._placeholderLabelFontSize=i,this._placeholderLabelFontColor=t.fontColor,this._placeholderLabelAlign=t.horizontalAlign,this._placeholderLineHeight=t.fontSize;var n=this._placeholderStyleSheet,o=t.color.toCSS(),r=t.fontSize,s="";switch(t.horizontalAlign){case tt.HorizontalAlign.LEFT:s="left";break;case tt.HorizontalAlign.CENTER:s="center";break;case tt.HorizontalAlign.RIGHT:s="right"}n.innerHTML="#"+this._domId+"::-webkit-input-placeholder{text-transform: initial;-family: "+e+";font-size: "+i+"px;color: "+o+";line-height: "+r+"px;text-align: "+s+";}#"+this._domId+"::-moz-placeholder{text-transform: initial;-family: "+e+";font-size: "+i+"px;color: "+o+";line-height: "+r+"px;text-align: "+s+";}#"+this._domId+"::-ms-input-placeholder{text-transform: initial;-family: "+e+";font-size: "+i+"px;color: "+o+";line-height: "+r+"px;text-align: "+s+";}",v.browserType===S.EDGE&&(n.innerHTML+="#"+this._domId+"::-ms-clear{display: none;}")}}},i._registerEventListeners=function(){var t=this;if(this._edTxt){var e=this._edTxt,i=!1,n=this.__eventListeners;n.compositionStart=function(){i=!0},n.compositionEnd=function(){i=!1,t._delegate._editBoxTextChanged(e.value)},n.onInput=function(){if(!i){var n=t._delegate,o=n.maxLength;o>=0&&(e.value=e.value.slice(0,o)),n._editBoxTextChanged(e.value)}},n.onClick=function(){t._editing&&v.isMobile&&t._adjustWindowScroll()},n.onKeydown=function(i){i.keyCode===Tt.ENTER?(i.propagationStopped=!0,t._delegate._editBoxEditingReturn(),t._isTextArea||e.blur()):i.keyCode===Tt.TAB&&(i.propagationStopped=!0,i.preventDefault(),se.next(t))},n.onBlur=function(){v.isMobile&&i&&n.compositionEnd(),t._editing=!1,Ue=null,t._hideDom(),t._delegate._editBoxEditingDidEnded()},e.addEventListener("compositionstart",n.compositionStart),e.addEventListener("compositionend",n.compositionEnd),e.addEventListener("input",n.onInput),e.addEventListener("keydown",n.onKeydown),e.addEventListener("blur",n.onBlur),e.addEventListener("touchstart",n.onClick)}},i._removeEventListeners=function(){if(this._edTxt){var t=this._edTxt,e=this.__eventListeners;t.removeEventListener("compositionstart",e.compositionStart),t.removeEventListener("compositionend",e.compositionEnd),t.removeEventListener("input",e.onInput),t.removeEventListener("keydown",e.onKeydown),t.removeEventListener("blur",e.onBlur),t.removeEventListener("touchstart",e.onClick),e.compositionStart=null,e.compositionEnd=null,e.onInput=null,e.onKeydown=null,e.onBlur=null,e.onClick=null}},e}(Me);!function(t){t.EDITING_DID_BEGAN="editing-did-began",t.EDITING_DID_ENDED="editing-did-ended",t.TEXT_CHANGED="text-changed",t.EDITING_RETURN="editing-return",t.XR_EDITING_DID_BEGAN="xr-editing-did-began",t.XR_EDITING_DID_ENDED="xr-editing-did-ended"}(He||(He={}));var je,Ze,Xe,Ye,Ke,qe,Qe,Je,$e,ti,ei,ii,ni,oi,ri,si,ai,hi,ci,li,_i,ui,di,pi,gi,fi,yi,Ti,vi,mi,Ci,Si,Ei,Li,Ai=(ae=n("cc.EditBox"),he=u(110),ce=d(Y),le=o(tt),_e=o(tt),ue=o(K),de=o(re),pe=o(oe),ge=o(ne),fe=o([ut]),ye=o([ut]),Te=o([ut]),ve=o([ut]),ae(me=he(me=ce(((Be=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).editingDidBegan=Se&&Se(),e.textChanged=Ee&&Ee(),e.editingDidEnded=Le&&Le(),e.editingReturn=Ae&&Ae(),e._impl=null,e._background=null,e._textLabel=Oe&&Oe(),e._placeholderLabel=be&&be(),e._returnType=De&&De(),e._string=Ie&&Ie(),e._tabIndex=Re&&Re(),e._backgroundImage=xe&&xe(),e._inputFlag=we&&we(),e._inputMode=Pe&&Pe(),e._maxLength=Ne&&Ne(),e._isLabelVisible=!1,e}r(e,t);var i=e.prototype;return i.__preload=function(){this._init()},i.onEnable=function(){this._registerEvent(),this._ensureBackgroundSprite(),this._impl&&this._impl.onEnable()},i.update=function(){this._impl&&this._impl.update()},i.onDisable=function(){this._unregisterEvent(),this._unregisterBackgroundEvent(),this._impl&&this._impl.onDisable()},i.onDestroy=function(){this._impl&&this._impl.clear()},i.setFocus=function(){this._impl&&this._impl.setFocus(!0)},i.focus=function(){this._impl&&this._impl.setFocus(!0)},i.blur=function(){this._impl&&this._impl.setFocus(!1)},i.isFocused=function(){return!!this._impl&&this._impl.isFocused()},i._editBoxEditingDidBegan=function(){ut.emitEvents(this.editingDidBegan,this),this.node.emit(He.EDITING_DID_BEGAN,this)},i._editBoxEditingDidEnded=function(t){ut.emitEvents(this.editingDidEnded,this),this.node.emit(He.EDITING_DID_ENDED,this,t)},i._editBoxTextChanged=function(t){t=this._updateLabelStringStyle(t,!0),this.string=t,ut.emitEvents(this.textChanged,t,this),this.node.emit(He.TEXT_CHANGED,this)},i._editBoxEditingReturn=function(t){ut.emitEvents(this.editingReturn,this),this.node.emit(He.EDITING_RETURN,this,t)},i._showLabels=function(){this._isLabelVisible=!0,this._updateLabels()},i._hideLabels=function(){this._isLabelVisible=!1,this._textLabel&&(this._textLabel.node.active=!1),this._placeholderLabel&&(this._placeholderLabel.node.active=!1)},i._onTouchBegan=function(t){t.propagationStopped=!0},i._onTouchCancel=function(t){t.propagationStopped=!0},i._onTouchEnded=function(t){this._impl&&this._impl.beginEditing(),t.propagationStopped=!0},i._init=function(){this._updatePlaceholderLabel(),this._updateTextLabel(),this._isLabelVisible=!0,this.node.on(_t.SIZE_CHANGED,this._resizeChildNodes,this),(this._impl=new e._EditBoxImpl).init(this),this._updateString(this._string),this._syncSize()},i._ensureBackgroundSprite=function(){if(!this._background){var t=this.node.getComponent(J);t||(t=this.node.addComponent(J)),t!==this._background&&(t.type=J.Type.SLICED,t.spriteFrame=this._backgroundImage,this._background=t,this._registerBackgroundEvent())}},i._updateTextLabel=function(){var t=this._textLabel;if(!t){var e=this.node.getChildByName("TEXT_LABEL");e||((e=new at("TEXT_LABEL")).layer=this.node.layer),(t=e.getComponent(tt))||(t=e.addComponent(tt)),e.parent=this.node,this._textLabel=t}this._inputMode===oe.ANY?(t.verticalAlign=et.TOP,t.enableWrapText=!0):t.enableWrapText=!1,t.string=this._updateLabelStringStyle(this._string)},i._updatePlaceholderLabel=function(){var t=this._placeholderLabel;if(!t){var e=this.node.getChildByName("PLACEHOLDER_LABEL");e||((e=new at("PLACEHOLDER_LABEL")).layer=this.node.layer),(t=e.getComponent(tt))||(t=e.addComponent(tt)),e.parent=this.node,this._placeholderLabel=t}this._inputMode===oe.ANY?t.enableWrapText=!0:t.enableWrapText=!1,t.string=this.placeholder},i._syncSize=function(){var t=this.node._uiProps.uiTransformComp,e=t.contentSize;if(this._background){var i=this._background.node._uiProps.uiTransformComp;i.anchorPoint=t.anchorPoint,i.setContentSize(e)}this._updateLabelPosition(e),this._impl&&this._impl.setSize(e.width,e.height)},i._updateLabels=function(){if(this._isLabelVisible){var t=this._string;this._textLabel&&(this._textLabel.node.active=""!==t),this._placeholderLabel&&(this._placeholderLabel.node.active=""===t)}},i._updateString=function(t){var e=this._textLabel;if(e){var i=t;i&&(i=this._updateLabelStringStyle(i)),e.string=i,this._updateLabels()}},i._updateLabelStringStyle=function(t,e){void 0===e&&(e=!1);var i,n=this._inputFlag;if(e||n!==re.PASSWORD)n===re.INITIAL_CAPS_ALL_CHARACTERS?t=t.toUpperCase():n===re.INITIAL_CAPS_WORD?t=t.replace(/(?:^|\s)\S/g,(function(t){return t.toUpperCase()})):n===re.INITIAL_CAPS_SENTENCE&&(t=(i=t).charAt(0).toUpperCase()+i.slice(1));else{for(var o="",r=t.length,s=0;s<r;++s)o+="●";t=o}return t},i._registerEvent=function(){this.node.on(_t.TOUCH_START,this._onTouchBegan,this),this.node.on(_t.TOUCH_END,this._onTouchEnded,this),this.node.on(pt.XRUI_UNCLICK,this._xrUnClick,this),this.node.on(gt.XR_KEYBOARD_INPUT,this._xrKeyBoardInput,this)},i._unregisterEvent=function(){this.node.off(_t.TOUCH_START,this._onTouchBegan,this),this.node.off(_t.TOUCH_END,this._onTouchEnded,this),this.node.off(pt.XRUI_UNCLICK,this._xrUnClick,this),this.node.off(gt.XR_KEYBOARD_INPUT,this._xrKeyBoardInput,this)},i._onBackgroundSpriteFrameChanged=function(){this._background&&(this.backgroundImage=this._background.spriteFrame)},i._registerBackgroundEvent=function(){var t=this._background&&this._background.node;null==t||t.on(J.EventType.SPRITE_FRAME_CHANGED,this._onBackgroundSpriteFrameChanged,this)},i._unregisterBackgroundEvent=function(){var t=this._background&&this._background.node;null==t||t.off(J.EventType.SPRITE_FRAME_CHANGED,this._onBackgroundSpriteFrameChanged,this)},i._updateLabelPosition=function(t){var e=this.node._uiProps.uiTransformComp,i=-e.anchorX*e.width,n=-e.anchorY*e.height,o=this._placeholderLabel,r=this._textLabel;r&&(r.node._uiProps.uiTransformComp.setContentSize(t.width-2,t.height),r.node.setPosition(i+2,n+t.height,r.node.position.z),this._inputMode===oe.ANY&&(r.verticalAlign=et.TOP),r.enableWrapText=this._inputMode===oe.ANY),o&&(o.node._uiProps.uiTransformComp.setContentSize(t.width-2,t.height),o.lineHeight=t.height,o.node.setPosition(i+2,n+t.height,o.node.position.z),o.enableWrapText=this._inputMode===oe.ANY)},i._resizeChildNodes=function(){var t=this.node._uiProps.uiTransformComp,e=this._textLabel&&this._textLabel.node;e&&(e.setPosition(-t.width/2,t.height/2,e.position.z),e._uiProps.uiTransformComp.setContentSize(t.contentSize));var i=this._placeholderLabel&&this._placeholderLabel.node;i&&(i.setPosition(-t.width/2,t.height/2,i.position.z),i._uiProps.uiTransformComp.setContentSize(t.contentSize));var n=this._background&&this._background.node;n&&n._uiProps.uiTransformComp.setContentSize(t.contentSize),this._syncSize()},i._xrUnClick=function(){this.node.emit(He.XR_EDITING_DID_BEGAN,this._maxLength,this.string)},i._xrKeyBoardInput=function(t){this.string=t},h(e,[{key:"string",get:function(){return this._string},set:function(t){this._maxLength>=0&&t.length>=this._maxLength&&(t=t.slice(0,this._maxLength)),this._string!==t&&(this._string=t,this._updateString(t))}},{key:"placeholder",get:function(){return this._placeholderLabel?this._placeholderLabel.string:""},set:function(t){this._placeholderLabel&&(this._placeholderLabel.string=t)}},{key:"textLabel",get:function(){return this._textLabel},set:function(t){this._textLabel!==t&&(this._textLabel=t,this._textLabel&&(this._updateTextLabel(),this._updateLabels()))}},{key:"placeholderLabel",get:function(){return this._placeholderLabel},set:function(t){this._placeholderLabel!==t&&(this._placeholderLabel=t,this._placeholderLabel&&(this._updatePlaceholderLabel(),this._updateLabels()))}},{key:"backgroundImage",get:function(){return this._backgroundImage},set:function(t){this._backgroundImage!==t&&(this._backgroundImage=t,this._ensureBackgroundSprite(),this._background.spriteFrame=t)}},{key:"inputFlag",get:function(){return this._inputFlag},set:function(t){this._inputFlag!==t&&(this._inputFlag=t,this._updateString(this._string))}},{key:"inputMode",get:function(){return this._inputMode},set:function(t){this._inputMode!==t&&(this._inputMode=t,this._updateTextLabel(),this._updatePlaceholderLabel())}},{key:"returnType",get:function(){return this._returnType},set:function(t){this._returnType=t}},{key:"maxLength",get:function(){return this._maxLength},set:function(t){this._maxLength=t}},{key:"tabIndex",get:function(){return this._tabIndex},set:function(t){this._tabIndex!==t&&(this._tabIndex=t,this._impl&&this._impl.setTabIndex(t))}}]),e}(dt))._EditBoxImpl=Me,Be.KeyboardReturnType=ne,Be.InputFlag=re,Be.InputMode=oe,Be.EventType=He,c((Ce=Be).prototype,"textLabel",[le],Object.getOwnPropertyDescriptor(Ce.prototype,"textLabel"),Ce.prototype),c(Ce.prototype,"placeholderLabel",[_e],Object.getOwnPropertyDescriptor(Ce.prototype,"placeholderLabel"),Ce.prototype),c(Ce.prototype,"backgroundImage",[ue],Object.getOwnPropertyDescriptor(Ce.prototype,"backgroundImage"),Ce.prototype),c(Ce.prototype,"inputFlag",[de],Object.getOwnPropertyDescriptor(Ce.prototype,"inputFlag"),Ce.prototype),c(Ce.prototype,"inputMode",[pe],Object.getOwnPropertyDescriptor(Ce.prototype,"inputMode"),Ce.prototype),c(Ce.prototype,"returnType",[ge],Object.getOwnPropertyDescriptor(Ce.prototype,"returnType"),Ce.prototype),Se=l(Ce.prototype,"editingDidBegan",[fe,p],(function(){return[]})),Ee=l(Ce.prototype,"textChanged",[ye,p],(function(){return[]})),Le=l(Ce.prototype,"editingDidEnded",[Te,p],(function(){return[]})),Ae=l(Ce.prototype,"editingReturn",[ve,p],(function(){return[]})),Oe=l(Ce.prototype,"_textLabel",[p],(function(){return null})),be=l(Ce.prototype,"_placeholderLabel",[p],(function(){return null})),De=l(Ce.prototype,"_returnType",[p],(function(){return ne.DEFAULT})),Ie=l(Ce.prototype,"_string",[p],(function(){return""})),Re=l(Ce.prototype,"_tabIndex",[p],(function(){return 0})),xe=l(Ce.prototype,"_backgroundImage",[p],(function(){return null})),we=l(Ce.prototype,"_inputFlag",[p],(function(){return re.DEFAULT})),Pe=l(Ce.prototype,"_inputMode",[p],(function(){return oe.ANY})),Ne=l(Ce.prototype,"_maxLength",[p],(function(){return 20})),me=Ce))||me)||me)||me);t({EditBox:Ai,EditBoxComponent:Ai}),"object"!=typeof window||"object"!=typeof document||L||A||O||(Ai._EditBoxImpl=We),_.internal.EditBox=Ai,function(t){t[t.NONE=0]="NONE",t[t.HORIZONTAL=1]="HORIZONTAL",t[t.VERTICAL=2]="VERTICAL",t[t.GRID=3]="GRID"}(vi||(vi={})),i(vi),function(t){t[t.NONE=0]="NONE",t[t.CONTAINER=1]="CONTAINER",t[t.CHILDREN=2]="CHILDREN"}(mi||(mi={})),i(mi),function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(Ci||(Ci={})),i(Ci),function(t){t[t.BOTTOM_TO_TOP=0]="BOTTOM_TO_TOP",t[t.TOP_TO_BOTTOM=1]="TOP_TO_BOTTOM"}(Si||(Si={})),i(Si),function(t){t[t.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",t[t.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT"}(Ei||(Ei={})),i(Ei),function(t){t[t.NONE=0]="NONE",t[t.FIXED_ROW=1]="FIXED_ROW",t[t.FIXED_COL=2]="FIXED_COL"}(Li||(Li={})),i(Li);var Oi,bi,Di,Ii,Ri,xi,wi,Pi,Ni,Bi,Hi,Mi,zi,ki,Vi=new a,Fi=(je=n("cc.Layout"),Ze=u(110),Xe=d(Y),Ye=o(vi),Ke=o(mi),qe=o(Ci),Qe=o(Si),Je=o(Ei),$e=o(Li),je(ti=Ze(ti=Xe(((Ti=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this)._resizeMode=ii&&ii(),e._layoutType=ni&&ni(),e._cellSize=oi&&oi(),e._startAxis=ri&&ri(),e._paddingLeft=si&&si(),e._paddingRight=ai&&ai(),e._paddingTop=hi&&hi(),e._paddingBottom=ci&&ci(),e._spacingX=li&&li(),e._spacingY=_i&&_i(),e._verticalDirection=ui&&ui(),e._horizontalDirection=di&&di(),e._constraint=pi&&pi(),e._constraintNum=gi&&gi(),e._affectedByScale=fi&&fi(),e._isAlign=yi&&yi(),e._layoutSize=new b(300,200),e._layoutDirty=!0,e._childrenDirty=!1,e._usefulLayoutObj=[],e._init=!1,e}r(e,t);var i=e.prototype;return i.updateLayout=function(t){void 0===t&&(t=!1),(this._layoutDirty||t)&&(this._doLayout(),this._layoutDirty=!1)},i.onEnable=function(){this._addEventListeners();var t=this.node._uiProps.uiTransformComp;t.contentSize.equals(b.ZERO)&&t.setContentSize(this._layoutSize),this._childrenChanged()},i.onDisable=function(){this._usefulLayoutObj.length=0,this._removeEventListeners()},i._checkUsefulObj=function(){this._usefulLayoutObj.length=0;for(var t=this.node.children,e=0;e<t.length;++e){var i=t[e],n=i._uiProps.uiTransformComp;i.activeInHierarchy&&n&&this._usefulLayoutObj.push(n)}},i._addEventListeners=function(){it.on(nt.EVENT_AFTER_UPDATE,this.updateLayout,this),this.node.on(_t.SIZE_CHANGED,this._resized,this),this.node.on(_t.ANCHOR_CHANGED,this._doLayoutDirty,this),this.node.on(_t.CHILD_ADDED,this._childAdded,this),this.node.on(_t.CHILD_REMOVED,this._childRemoved,this),this.node.on(_t.SIBLING_ORDER_CHANGED,this._childrenChanged,this),this.node.on("childrenSiblingOrderChanged",this.updateLayout,this),this._addChildrenEventListeners()},i._removeEventListeners=function(){it.off(nt.EVENT_AFTER_UPDATE,this.updateLayout,this),this.node.off(_t.SIZE_CHANGED,this._resized,this),this.node.off(_t.ANCHOR_CHANGED,this._doLayoutDirty,this),this.node.off(_t.CHILD_ADDED,this._childAdded,this),this.node.off(_t.CHILD_REMOVED,this._childRemoved,this),this.node.off(_t.SIBLING_ORDER_CHANGED,this._childrenChanged,this),this.node.off("childrenSiblingOrderChanged",this.updateLayout,this),this._removeChildrenEventListeners()},i._addChildrenEventListeners=function(){for(var t=this.node.children,e=0;e<t.length;++e){var i=t[e];i.on(_t.SIZE_CHANGED,this._doLayoutDirty,this),i.on(_t.TRANSFORM_CHANGED,this._transformDirty,this),i.on(_t.ANCHOR_CHANGED,this._doLayoutDirty,this),i.on(_t.ACTIVE_IN_HIERARCHY_CHANGED,this._childrenChanged,this)}},i._removeChildrenEventListeners=function(){for(var t=this.node.children,e=0;e<t.length;++e){var i=t[e];i.off(_t.SIZE_CHANGED,this._doLayoutDirty,this),i.off(_t.TRANSFORM_CHANGED,this._transformDirty,this),i.off(_t.ANCHOR_CHANGED,this._doLayoutDirty,this),i.off(_t.ACTIVE_IN_HIERARCHY_CHANGED,this._childrenChanged,this)}},i._childAdded=function(t){t.on(_t.SIZE_CHANGED,this._doLayoutDirty,this),t.on(_t.TRANSFORM_CHANGED,this._transformDirty,this),t.on(_t.ANCHOR_CHANGED,this._doLayoutDirty,this),t.on(_t.ACTIVE_IN_HIERARCHY_CHANGED,this._childrenChanged,this),this._childrenChanged()},i._childRemoved=function(t){t.off(_t.SIZE_CHANGED,this._doLayoutDirty,this),t.off(_t.TRANSFORM_CHANGED,this._transformDirty,this),t.off(_t.ANCHOR_CHANGED,this._doLayoutDirty,this),t.off(_t.ACTIVE_IN_HIERARCHY_CHANGED,this._childrenChanged,this),this._childrenChanged()},i._resized=function(){this._layoutSize.set(this.node._uiProps.uiTransformComp.contentSize),this._doLayoutDirty()},i._doLayoutHorizontally=function(t,e,i,n){var o=this.node._uiProps.uiTransformComp.anchorPoint,r=this._getFixedBreakingNum(),s=1,a=this._paddingLeft;this._horizontalDirection===Ei.RIGHT_TO_LEFT&&(s=-1,a=this._paddingRight);var h=(this._horizontalDirection-o.x)*t+s*a,c=h-s*this._spacingX,l=0,_=0,u=0,d=0,p=!1,g=this._usefulLayoutObj.length,f=this._cellSize.width,y=this._getPaddingH();this._layoutType!==vi.GRID&&this._resizeMode===mi.CHILDREN&&(f=(t-y-(g-1)*this._spacingX)/g);for(var T=this._usefulLayoutObj,v=0;v<T.length;++v){var m=T[v],C=m.node,S=C.scale,E=this._getUsedScaleValue(S.x),L=this._getUsedScaleValue(S.y);this._resizeMode===mi.CHILDREN&&(m.width=f/E,this._layoutType===vi.GRID&&(m.height=this._cellSize.height/L));var A=Math.abs(this._horizontalDirection-m.anchorX),O=m.width*E,b=m.height*L;b>u&&(d=Math.max(u,d),_=u||b,u=b),c+=s*(A*O+this._spacingX);var D=s*(1-A)*O;if(e){if(r>0)(p=v/r>0&&v%r==0)&&(_=u>b?u:_);else if(O>t-y)c>h+s*A*O&&(p=!0);else{var I=(1-this._horizontalDirection-o.x)*t,R=c+D+s*(s>0?this._paddingRight:this._paddingLeft);p=Math.abs(R)>Math.abs(I)}p&&(c=h+s*A*O,b!==u&&(_=u),l+=_+this._spacingY,_=u=b)}var x=i(C,m,l);n&&C.setPosition(c,x),c+=D}return _=Math.max(_,u),Math.max(d,l+_)+this._getPaddingV()},i._doLayoutVertically=function(t,e,i,n){var o=this.node._uiProps.uiTransformComp.anchorPoint,r=this._getFixedBreakingNum(),s=1,a=this._paddingBottom;this._verticalDirection===Si.TOP_TO_BOTTOM&&(s=-1,a=this._paddingTop);var h=(this._verticalDirection-o.y)*t+s*a,c=h-s*this._spacingY,l=0,_=0,u=0,d=0,p=!1,g=this._usefulLayoutObj.length,f=this._cellSize.height,y=this._getPaddingV();this._layoutType!==vi.GRID&&this._resizeMode===mi.CHILDREN&&(f=(t-y-(g-1)*this._spacingY)/g);for(var T=this._usefulLayoutObj,v=0;v<T.length;++v){var m=T[v],C=m.node,S=C.scale,E=this._getUsedScaleValue(S.x),L=this._getUsedScaleValue(S.y);this._resizeMode===mi.CHILDREN&&(m.height=f/L,this._layoutType===vi.GRID&&(m.width=this._cellSize.width/E));var A=Math.abs(this._verticalDirection-m.anchorY),O=m.width*E,b=m.height*L;O>l&&(_=Math.max(l,_),u=l||O,l=O),c+=s*(A*b+this._spacingY);var D=s*(1-A)*b;if(e){if(r>0)(p=v/r>0&&v%r==0)&&(u=l>b?l:u);else if(b>t-y)c>h+s*A*b&&(p=!0);else{var I=(1-this._verticalDirection-o.y)*t,R=c+D+s*(s>0?this._paddingTop:this._paddingBottom);p=Math.abs(R)>Math.abs(I)}p&&(c=h+s*A*b,O!==l&&(u=l),d+=u+this._spacingX,u=l=O)}var x=i(C,m,d);n&&(C.getPosition(Vi),C.setPosition(x,c,Vi.z)),c+=D}return u=Math.max(u,l),Math.max(_,d+u)+this._getPaddingH()},i._doLayoutGridAxisHorizontal=function(t,e){var i=this,n=e.width,o=1,r=-t.y*e.height,s=this._paddingBottom;this._verticalDirection===Si.TOP_TO_BOTTOM&&(o=-1,r=(1-t.y)*e.height,s=this._paddingTop);var a=function(t,e,n){return r+o*(n+(1-e.anchorY)*e.height*i._getUsedScaleValue(t.scale.y)+s)},h=0;this._resizeMode===mi.CONTAINER&&(h=this._doLayoutHorizontally(n,!0,a,!1),r=-t.y*h,this._verticalDirection===Si.TOP_TO_BOTTOM&&(o=-1,r=(1-t.y)*h)),this._doLayoutHorizontally(n,!0,a,!0),this._resizeMode===mi.CONTAINER&&this.node._uiProps.uiTransformComp.setContentSize(n,h)},i._doLayoutGridAxisVertical=function(t,e){var i=this,n=e.height,o=1,r=-t.x*e.width,s=this._paddingLeft;this._horizontalDirection===Ei.RIGHT_TO_LEFT&&(o=-1,r=(1-t.x)*e.width,s=this._paddingRight);var a=function(t,e,n){return r+o*(n+(1-e.anchorX)*e.width*i._getUsedScaleValue(t.scale.x)+s)},h=0;this._resizeMode===mi.CONTAINER&&(h=this._doLayoutVertically(n,!0,a,!1),r=-t.x*h,this._horizontalDirection===Ei.RIGHT_TO_LEFT&&(o=-1,r=(1-t.x)*h)),this._doLayoutVertically(n,!0,a,!0),this._resizeMode===mi.CONTAINER&&this.node._uiProps.uiTransformComp.setContentSize(h,n)},i._doLayoutGrid=function(){var t=this.node._uiProps.uiTransformComp,e=t.anchorPoint,i=t.contentSize;this.startAxis===Ci.HORIZONTAL?this._doLayoutGridAxisHorizontal(e,i):this.startAxis===Ci.VERTICAL&&this._doLayoutGridAxisVertical(e,i)},i._getHorizontalBaseWidth=function(){var t=this._usefulLayoutObj,e=0,i=t.length;if(this._resizeMode===mi.CONTAINER){for(var n=0;n<t.length;++n){var o=t[n],r=o.node.scale;e+=o.width*this._getUsedScaleValue(r.x)}e+=(i-1)*this._spacingX+this._getPaddingH()}else e=this.node._uiProps.uiTransformComp.width;return e},i._getVerticalBaseHeight=function(){var t=this._usefulLayoutObj,e=0,i=t.length;if(this._resizeMode===mi.CONTAINER){for(var n=0;n<t.length;++n){var o=t[n],r=o.node.scale;e+=o.height*this._getUsedScaleValue(r.y)}e+=(i-1)*this._spacingY+this._getPaddingV()}else e=this.node._uiProps.uiTransformComp.height;return e},i._doLayout=function(){var t=this;if(this._init&&!this._childrenDirty||(this._checkUsefulObj(),this._init=!0,this._childrenDirty=!1),this._layoutType===vi.HORIZONTAL){var e=this._getHorizontalBaseWidth();this._doLayoutHorizontally(e,!1,(function(e){return(t._isAlign?a.ZERO:e.position).y}),!0),this.node._uiProps.uiTransformComp.width=e}else if(this._layoutType===vi.VERTICAL){var i=this._getVerticalBaseHeight();this._doLayoutVertically(i,!1,(function(e){return(t._isAlign?a.ZERO:e.position).x}),!0),this.node._uiProps.uiTransformComp.height=i}else this._layoutType===vi.GRID&&this._doLayoutGrid()},i._getUsedScaleValue=function(t){return this._affectedByScale?Math.abs(t):1},i._transformDirty=function(t){t&st.SCALE&&t&st.POSITION&&this._affectedByScale&&this._doLayoutDirty()},i._doLayoutDirty=function(){this._layoutDirty=!0},i._childrenChanged=function(){this._childrenDirty=!0,this._doLayoutDirty()},i._getPaddingH=function(){return this._paddingLeft+this._paddingRight},i._getPaddingV=function(){return this._paddingTop+this._paddingBottom},i._getFixedBreakingNum=function(){if(this._layoutType!==vi.GRID||this._constraint===Li.NONE||this._constraintNum<=0)return 0;var t=this._constraint===Li.FIXED_ROW?Math.ceil(this._usefulLayoutObj.length/this._constraintNum):this._constraintNum;return this._startAxis===Ci.VERTICAL&&(t=this._constraint===Li.FIXED_COL?Math.ceil(this._usefulLayoutObj.length/this._constraintNum):this._constraintNum),t},h(e,[{key:"alignHorizontal",get:function(){return this._isAlign},set:function(t){this._layoutType===vi.HORIZONTAL&&(this._isAlign=t,this._doLayoutDirty())}},{key:"alignVertical",get:function(){return this._isAlign},set:function(t){this._layoutType===vi.VERTICAL&&(this._isAlign=t,this._doLayoutDirty())}},{key:"type",get:function(){return this._layoutType},set:function(t){this._layoutType=t,this._doLayoutDirty()}},{key:"resizeMode",get:function(){return this._resizeMode},set:function(t){this._layoutType!==vi.NONE&&(this._resizeMode=t,this._doLayoutDirty())}},{key:"cellSize",get:function(){return this._cellSize},set:function(t){this._cellSize!==t&&(this._cellSize.set(t),this._doLayoutDirty())}},{key:"startAxis",get:function(){return this._startAxis},set:function(t){this._startAxis!==t&&(this._startAxis=t,this._doLayoutDirty())}},{key:"paddingLeft",get:function(){return this._paddingLeft},set:function(t){this._paddingLeft!==t&&(this._paddingLeft=t,this._doLayoutDirty())}},{key:"paddingRight",get:function(){return this._paddingRight},set:function(t){this._paddingRight!==t&&(this._paddingRight=t,this._doLayoutDirty())}},{key:"paddingTop",get:function(){return this._paddingTop},set:function(t){this._paddingTop!==t&&(this._paddingTop=t,this._doLayoutDirty())}},{key:"paddingBottom",get:function(){return this._paddingBottom},set:function(t){this._paddingBottom!==t&&(this._paddingBottom=t,this._doLayoutDirty())}},{key:"spacingX",get:function(){return this._spacingX},set:function(t){this._spacingX!==t&&(this._spacingX=t,this._doLayoutDirty())}},{key:"spacingY",get:function(){return this._spacingY},set:function(t){this._spacingY!==t&&(this._spacingY=t,this._doLayoutDirty())}},{key:"verticalDirection",get:function(){return this._verticalDirection},set:function(t){this._verticalDirection!==t&&(this._verticalDirection=t,this._doLayoutDirty())}},{key:"horizontalDirection",get:function(){return this._horizontalDirection},set:function(t){this._horizontalDirection!==t&&(this._horizontalDirection=t,this._doLayoutDirty())}},{key:"padding",get:function(){return this._paddingLeft},set:function(t){this.paddingLeft===t&&this._paddingRight===t&&this._paddingTop===t&&this._paddingBottom===t||(this._paddingLeft=this._paddingRight=this._paddingTop=this._paddingBottom=t,this._doLayoutDirty())}},{key:"constraint",get:function(){return this._constraint},set:function(t){this._layoutType!==vi.NONE&&this._constraint!==t&&(this._constraint=t,this._doLayoutDirty())}},{key:"constraintNum",get:function(){return this._constraintNum},set:function(t){this._constraint!==Li.NONE&&this._constraintNum!==t&&(t<=0&&D("Limit values to be greater than 0"),this._constraintNum=t,this._doLayoutDirty())}},{key:"affectedByScale",get:function(){return this._affectedByScale},set:function(t){this._affectedByScale=t,this._doLayoutDirty()}}]),e}(dt)).Type=vi,Ti.VerticalDirection=Si,Ti.HorizontalDirection=Ei,Ti.ResizeMode=mi,Ti.AxisDirection=Ci,Ti.Constraint=Li,c((ei=Ti).prototype,"type",[Ye],Object.getOwnPropertyDescriptor(ei.prototype,"type"),ei.prototype),c(ei.prototype,"resizeMode",[Ke],Object.getOwnPropertyDescriptor(ei.prototype,"resizeMode"),ei.prototype),c(ei.prototype,"startAxis",[qe],Object.getOwnPropertyDescriptor(ei.prototype,"startAxis"),ei.prototype),c(ei.prototype,"verticalDirection",[Qe],Object.getOwnPropertyDescriptor(ei.prototype,"verticalDirection"),ei.prototype),c(ei.prototype,"horizontalDirection",[Je],Object.getOwnPropertyDescriptor(ei.prototype,"horizontalDirection"),ei.prototype),c(ei.prototype,"constraint",[$e],Object.getOwnPropertyDescriptor(ei.prototype,"constraint"),ei.prototype),ii=l(ei.prototype,"_resizeMode",[p],(function(){return mi.NONE})),ni=l(ei.prototype,"_layoutType",[p],(function(){return vi.NONE})),oi=l(ei.prototype,"_cellSize",[p],(function(){return new b(40,40)})),ri=l(ei.prototype,"_startAxis",[p],(function(){return Ci.HORIZONTAL})),si=l(ei.prototype,"_paddingLeft",[p],(function(){return 0})),ai=l(ei.prototype,"_paddingRight",[p],(function(){return 0})),hi=l(ei.prototype,"_paddingTop",[p],(function(){return 0})),ci=l(ei.prototype,"_paddingBottom",[p],(function(){return 0})),li=l(ei.prototype,"_spacingX",[p],(function(){return 0})),_i=l(ei.prototype,"_spacingY",[p],(function(){return 0})),ui=l(ei.prototype,"_verticalDirection",[p],(function(){return Si.TOP_TO_BOTTOM})),di=l(ei.prototype,"_horizontalDirection",[p],(function(){return Ei.LEFT_TO_RIGHT})),pi=l(ei.prototype,"_constraint",[p],(function(){return Li.NONE})),gi=l(ei.prototype,"_constraintNum",[p],(function(){return 2})),fi=l(ei.prototype,"_affectedByScale",[p],(function(){return!1})),yi=l(ei.prototype,"_isAlign",[p],(function(){return!1})),ti=ei))||ti)||ti)||ti);t({Layout:Fi,LayoutComponent:Fi}),_.Layout=Fi,function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL",t[t.FILLED=2]="FILLED"}(ki||(ki={})),g(ki);var Ui,Gi,Wi,ji,Zi,Xi,Yi,Ki,qi,Qi,Ji,$i,tn,en=(Oi=n("cc.ProgressBar"),bi=u(110),Di=d(Y),Ii=o(J),Ri=o(ki),Oi(xi=bi(xi=Di(((zi=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this)._barSprite=Pi&&Pi(),e._mode=Ni&&Ni(),e._totalLength=Bi&&Bi(),e._progress=Hi&&Hi(),e._reverse=Mi&&Mi(),e}r(e,t);var i=e.prototype;return i._initBarSprite=function(){if(this._barSprite){var t=this._barSprite.node;if(!t)return;var e=this.node._uiProps.uiTransformComp,i=e.contentSize,n=e.anchorPoint,o=t._uiProps.uiTransformComp.contentSize;if(this._barSprite.fillType===J.FillType.RADIAL&&(this._mode=ki.FILLED),this._mode===ki.HORIZONTAL?this.totalLength=o.width:this._mode===ki.VERTICAL?this.totalLength=o.height:this.totalLength=this._barSprite.fillRange,t.parent===this.node){var r=-i.width*n.x;t.setPosition(r,0,0)}}},i._updateBarStatus=function(){if(this._barSprite){var t=this._barSprite.node;if(!t)return;var e=t._uiProps.uiTransformComp,i=e.anchorPoint,n=e.contentSize,o=t.getPosition(),r=new I(0,.5),s=R(this._progress),h=this._totalLength*s,c=n,l=0,_=0;switch(this._mode){case ki.HORIZONTAL:this._reverse&&(r=new I(1,.5)),c=new b(h,n.height),l=this._totalLength,_=n.height;break;case ki.VERTICAL:r=this._reverse?new I(.5,1):new I(.5,0),c=new b(n.width,h),l=n.width,_=this._totalLength}if(this._mode===ki.FILLED)this._barSprite.type!==J.Type.FILLED?D("ProgressBar FILLED mode only works when barSprite's Type is FILLED!"):(this._reverse&&(h*=-1),this._barSprite.fillRange=h);else if(this._barSprite.type!==J.Type.FILLED){var u=r.x-i.x,d=r.y-i.y,p=new a(l*u,_*d,0);t.setPosition(o.x+p.x,o.y+p.y,o.z),e.setAnchorPoint(r),e.setContentSize(c)}else D("ProgressBar non-FILLED mode only works when barSprite's Type is non-FILLED!")}},h(e,[{key:"barSprite",get:function(){return this._barSprite},set:function(t){this._barSprite!==t&&(this._barSprite=t,this._initBarSprite())}},{key:"mode",get:function(){return this._mode},set:function(t){if(this._mode!==t&&(this._mode=t,this._barSprite)){var e=this._barSprite.node;if(!e)return;var i=e._uiProps.uiTransformComp.contentSize;this._mode===ki.HORIZONTAL?this.totalLength=i.width:this._mode===ki.VERTICAL?this.totalLength=i.height:this._mode===ki.FILLED&&(this.totalLength=this._barSprite.fillRange)}}},{key:"totalLength",get:function(){return this._totalLength},set:function(t){this._mode===ki.FILLED&&(t=R(t)),this._totalLength!==t&&(this._totalLength=t,this._updateBarStatus())}},{key:"progress",get:function(){return this._progress},set:function(t){this._progress!==t&&(this._progress=t,this._updateBarStatus())}},{key:"reverse",get:function(){return this._reverse},set:function(t){this._reverse!==t&&(this._reverse=t,this._barSprite&&(this._barSprite.fillStart=1-this._barSprite.fillStart),this._updateBarStatus())}}]),e}(dt)).Mode=ki,c((wi=zi).prototype,"barSprite",[Ii],Object.getOwnPropertyDescriptor(wi.prototype,"barSprite"),wi.prototype),c(wi.prototype,"mode",[Ri],Object.getOwnPropertyDescriptor(wi.prototype,"mode"),wi.prototype),Pi=l(wi.prototype,"_barSprite",[p],(function(){return null})),Ni=l(wi.prototype,"_mode",[p],(function(){return ki.HORIZONTAL})),Bi=l(wi.prototype,"_totalLength",[p],(function(){return 1})),Hi=l(wi.prototype,"_progress",[p],(function(){return.1})),Mi=l(wi.prototype,"_reverse",[p],(function(){return!1})),xi=wi))||xi)||xi)||xi);t({ProgressBar:en,ProgressBarComponent:en}),_.ProgressBar=en;var nn,on=new a,rn=new a,sn=new a,an=new I,hn=new e,cn=new I;!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(nn||(nn={})),i(nn);var ln,_n=(Ui=n("cc.ScrollBar"),Gi=u(110),Wi=d(Y),ji=o(J),Zi=o(nn),Ui(Xi=Gi(Xi=Wi(((tn=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this)._scrollView=Ki&&Ki(),e._handle=qi&&qi(),e._direction=Qi&&Qi(),e._enableAutoHide=Ji&&Ji(),e._autoHideTime=$i&&$i(),e._touching=!1,e._opacity=255,e._autoHideRemainingTime=0,e}r(e,t);var i=e.prototype;return i.hide=function(){this._autoHideRemainingTime=0,this._setOpacity(0)},i.show=function(){this._autoHideRemainingTime=this._autoHideTime,this._opacity=255,this._setOpacity(this._opacity)},i.onScroll=function(t){if(this._scrollView){var e=this._scrollView.content;if(e){var i=e._uiProps.uiTransformComp.contentSize,n=this._scrollView.node._uiProps.uiTransformComp.contentSize,o=this.node._uiProps.uiTransformComp.contentSize;if(!this._conditionalDisableScrollBar(i,n)){this._enableAutoHide&&(this._autoHideRemainingTime=this._autoHideTime,this._setOpacity(this._opacity));var r=0,s=0,a=0,h=0,c=0,l=cn;l.set(0,0),this._direction===nn.HORIZONTAL?(r=i.width,s=n.width,c=o.width,a=t.x,this._convertToScrollViewSpace(l,e),h=-l.x):this._direction===nn.VERTICAL&&(r=i.height,s=n.height,c=o.height,a=t.y,this._convertToScrollViewSpace(l,e),h=-l.y);var _=this._calculateLength(r,s,c,a),u=cn;this._calculatePosition(u,r,s,c,h,a,_),this._updateLength(_),this._updateHandlerPosition(u)}}}},i.setScrollView=function(t){this._scrollView=t},i.onTouchBegan=function(){this._enableAutoHide&&(this._touching=!0)},i.onTouchEnded=function(){if(this._enableAutoHide&&(this._touching=!1,!(this._autoHideTime<=0))){if(this._scrollView){var t=this._scrollView.content;if(t){var e=t._uiProps.uiTransformComp.contentSize,i=this._scrollView.node._uiProps.uiTransformComp.contentSize;if(this._conditionalDisableScrollBar(e,i))return}}this._autoHideRemainingTime=this._autoHideTime}},i.onEnable=function(){var t=this.node.getComponent(J);t&&(this._opacity=t.color.a)},i.start=function(){this._enableAutoHide&&this._setOpacity(0)},i.update=function(t){this._processAutoHide(t)},i._convertToScrollViewSpace=function(t,e){var i=this._scrollView&&this._scrollView.node._uiProps.uiTransformComp,n=e._uiProps.uiTransformComp;if(i&&n){on.set(-n.anchorX*n.width,-n.anchorY*n.height,0),n.convertToWorldSpaceAR(on,rn);var o=i.convertToNodeSpaceAR(rn);o.x+=i.anchorX*i.width,o.y+=i.anchorY*i.height,t.set(o.x,o.y)}else t.set(I.ZERO)},i._setOpacity=function(t){if(this._handle){var e=this.node.getComponent(J);e&&(hn.set(e.color),hn.a=t,e.color=hn),(e=this._handle.getComponent(J))&&(hn.set(e.color),hn.a=t,e.color=hn)}},i._updateHandlerPosition=function(t){if(this._handle){var e=sn;this._fixupHandlerPosition(e),this._handle.node.setPosition(t.x+e.x,t.y+e.y,e.z)}},i._fixupHandlerPosition=function(t){var e=this.node._uiProps.uiTransformComp,i=e.contentSize,n=e.anchorPoint,o=this.handle.node._uiProps.uiTransformComp.contentSize,r=this.handle.node.parent;a.set(on,-i.width*n.x,-i.height*n.y,0);var s=this.node._uiProps.uiTransformComp.convertToWorldSpaceAR(on,rn),h=t;h.set(0,0,0),r._uiProps.uiTransformComp.convertToNodeSpaceAR(s,h),this.direction===nn.HORIZONTAL?h.set(h.x,h.y+(i.height-o.height)/2,h.z):this.direction===nn.VERTICAL&&h.set(h.x+(i.width-o.width)/2,h.y,h.z),this.handle.node.setPosition(h)},i._conditionalDisableScrollBar=function(t,e){return t.width<=e.width&&this._direction===nn.HORIZONTAL||t.height<=e.height&&this._direction===nn.VERTICAL},i._calculateLength=function(t,e,i,n){var o=t;return n&&(o+=20*(n>0?n:-n)),i*(e/o)},i._calculatePosition=function(t,e,i,n,o,r,s){var a=e-i;r&&(a+=Math.abs(r));var h=0;a&&(h=R(h=o/a));var c=(n-s)*h;this._direction===nn.VERTICAL?t.set(0,c):t.set(c,0)},i._updateLength=function(t){if(this._handle){var e=this._handle.node._uiProps.uiTransformComp,i=e.contentSize,n=e.anchorPoint;n.x===an.x&&n.y===an.y||e.setAnchorPoint(an),this._direction===nn.HORIZONTAL?e.setContentSize(t,i.height):e.setContentSize(i.width,t)}},i._processAutoHide=function(t){if(this._enableAutoHide&&!(this._autoHideRemainingTime<=0)&&!this._touching&&(this._autoHideRemainingTime-=t,this._autoHideRemainingTime<=this._autoHideTime)){this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime);var e=this._opacity*(this._autoHideRemainingTime/this._autoHideTime);this._setOpacity(e)}},h(e,[{key:"handle",get:function(){return this._handle},set:function(t){this._handle!==t&&(this._handle=t,this.onScroll(I.ZERO))}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction!==t&&(this._direction=t,this.onScroll(I.ZERO))}},{key:"enableAutoHide",get:function(){return this._enableAutoHide},set:function(t){this._enableAutoHide!==t&&(this._enableAutoHide=t,this._enableAutoHide&&this._setOpacity(0))}},{key:"autoHideTime",get:function(){return this._autoHideTime},set:function(t){this._autoHideTime!==t&&(this._autoHideTime=t)}}]),e}(dt)).Direction=nn,c((Yi=tn).prototype,"handle",[ji],Object.getOwnPropertyDescriptor(Yi.prototype,"handle"),Yi.prototype),c(Yi.prototype,"direction",[Zi],Object.getOwnPropertyDescriptor(Yi.prototype,"direction"),Yi.prototype),Ki=l(Yi.prototype,"_scrollView",[p],(function(){return null})),qi=l(Yi.prototype,"_handle",[p],(function(){return null})),Qi=l(Yi.prototype,"_direction",[p],(function(){return nn.HORIZONTAL})),Ji=l(Yi.prototype,"_enableAutoHide",[p],(function(){return!1})),$i=l(Yi.prototype,"_autoHideTime",[p],(function(){return 1})),Xi=Yi))||Xi)||Xi)||Xi);t({ScrollBar:_n,ScrollBarComponent:_n}),_.ScrollBar=_n;var un,dn,pn,gn,fn,yn,Tn,vn,mn,Cn,Sn,En,Ln,An,On,bn,Dn,In,Rn,xn,wn,Pn=t("ViewGroup",n("cc.ViewGroup")(ln=u(110)(ln=function(t){function e(){return t.apply(this,arguments)||this}return r(e,t),e}(dt))||ln)||ln);_.ViewGroup=Pn;var Nn,Bn,Hn=1e-4,Mn=new a,zn=new a,kn=new I,Vn=new I,Fn=function(){return(new Date).getMilliseconds()},Un={"scroll-to-top":0,"scroll-to-bottom":1,"scroll-to-left":2,"scroll-to-right":3,scrolling:4,"bounce-bottom":6,"bounce-left":7,"bounce-right":8,"bounce-top":5,"scroll-ended":9,"touch-up":10,"scroll-ended-with-threshold":11,"scroll-began":12};!function(t){t.SCROLL_TO_TOP="scroll-to-top",t.SCROLL_TO_BOTTOM="scroll-to-bottom",t.SCROLL_TO_LEFT="scroll-to-left",t.SCROLL_TO_RIGHT="scroll-to-right",t.SCROLL_BEGAN="scroll-began",t.SCROLL_ENDED="scroll-ended",t.BOUNCE_TOP="bounce-top",t.BOUNCE_BOTTOM="bounce-bottom",t.BOUNCE_LEFT="bounce-left",t.BOUNCE_RIGHT="bounce-right",t.SCROLLING="scrolling",t.SCROLL_ENG_WITH_THRESHOLD="scroll-ended-with-threshold",t.TOUCH_UP="touch-up"}(Nn||(Nn={})),function(t){t[t.NONE=0]="NONE",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT"}(Bn||(Bn={}));var Gn,Wn,jn,Zn,Xn,Yn,Kn,qn,Qn,Jn,$n,to,eo,io=(un=n("cc.ScrollView"),dn=u(110),pn=d(Y),gn=o(at),fn=o(_n),yn=o(_n),Tn=o([ut]),un(vn=dn(vn=pn(((wn=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).bounceDuration=Cn&&Cn(),e.brake=Sn&&Sn(),e.elastic=En&&En(),e.inertia=Ln&&Ln(),e.horizontal=An&&An(),e.vertical=On&&On(),e.cancelInnerEvents=bn&&bn(),e.scrollEvents=Dn&&Dn(),e._autoScrolling=!1,e._scrolling=!1,e._content=In&&In(),e._horizontalScrollBar=Rn&&Rn(),e._verticalScrollBar=xn&&xn(),e._topBoundary=0,e._bottomBoundary=0,e._leftBoundary=0,e._rightBoundary=0,e._touchMoveDisplacements=[],e._touchMoveTimeDeltas=[],e._touchMovePreviousTimestamp=0,e._touchMoved=!1,e._autoScrollAttenuate=!1,e._autoScrollStartPosition=new a,e._autoScrollTargetDelta=new a,e._autoScrollTotalTime=0,e._autoScrollAccumulatedTime=0,e._autoScrollCurrentlyOutOfBoundary=!1,e._autoScrollBraking=!1,e._autoScrollBrakingStartPosition=new a,e._outOfBoundaryAmount=new a,e._outOfBoundaryAmountDirty=!0,e._stopMouseWheel=!1,e._mouseWheelEventElapsedTime=0,e._isScrollEndedWithThresholdEventFired=!1,e._scrollEventEmitMask=0,e._isBouncing=!1,e._contentPos=new a,e._deltaPos=new a,e._hoverIn=Bn.NONE,e}r(e,t);var i=e.prototype;return i.scrollToBottom=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new I(0,0),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i,!0)},i.scrollToTop=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new I(0,1),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToLeft=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new I(0,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToRight=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new I(1,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToTopLeft=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new I(0,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToTopRight=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new I(1,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToBottomLeft=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new I(0,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToBottomRight=function(t,e){void 0===e&&(e=!0);var i=this._calculateMovePercentDelta({anchor:new I(1,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},i.scrollToOffset=function(t,e,i){void 0===i&&(i=!0);var n=this.getMaxScrollOffset(),o=new I(0,0);0===n.x?o.x=0:o.x=t.x/n.x,0===n.y?o.y=1:o.y=(n.y-t.y)/n.y,this.scrollTo(o,e,i)},i.getScrollOffset=function(){var t=this._getContentTopBoundary()-this._topBoundary,e=this._getContentLeftBoundary()-this._leftBoundary;return new I(e,t)},i.getMaxScrollOffset=function(){if(!this._content||!this.view)return I.ZERO;var t=this._content._uiProps.uiTransformComp.contentSize,e=t.width-this.view.width,i=t.height-this.view.height;return new I(e=e>=0?e:0,i=i>=0?i:0)},i.scrollToPercentHorizontal=function(t,e,i){var n=this._calculateMovePercentDelta({anchor:new I(t,0),applyToHorizontal:!0,applyToVertical:!1});e?this._startAutoScroll(n,e,!1!==i):this._moveContent(n)},i.scrollTo=function(t,e,i){var n=this._calculateMovePercentDelta({anchor:new I(t),applyToHorizontal:!0,applyToVertical:!0});e?this._startAutoScroll(n,e,i):this._moveContent(n)},i.scrollToPercentVertical=function(t,e,i){var n=this._calculateMovePercentDelta({anchor:new I(0,t),applyToHorizontal:!1,applyToVertical:!0});e?this._startAutoScroll(n,e,i):this._moveContent(n)},i.stopAutoScroll=function(){this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},i.setContentPosition=function(t){this._setContentPosition(t)},i._setContentPosition=function(t){if(this._content){var e=this._getContentPosition();Math.abs(t.x-e.x)<Hn&&Math.abs(t.y-e.y)<Hn||(this._content.setPosition(t),this._outOfBoundaryAmountDirty=!0)}},i.getContentPosition=function(){return this._getContentPosition()},i._getContentPosition=function(){return this._content?(this._contentPos.set(this._content.position),this._contentPos):a.ZERO.clone()},i.isScrolling=function(){return this._scrolling},i.isAutoScrolling=function(){return this._autoScrolling},i.getScrollEndedEventTiming=function(){return Hn},i.start=function(){this._calculateBoundary(),this._content&&it.once(nt.EVENT_BEFORE_DRAW,this._adjustContentOutOfBoundary,this)},i.onEnable=function(){this._registerEvent(),this._content&&(this._content.on(_t.SIZE_CHANGED,this._calculateBoundary,this),this._content.on(_t.TRANSFORM_CHANGED,this._scaleChanged,this),this.view&&(this.view.node.on(_t.TRANSFORM_CHANGED,this._scaleChanged,this),this.view.node.on(_t.SIZE_CHANGED,this._calculateBoundary,this))),this._calculateBoundary(),this._updateScrollBarState()},i.update=function(t){this._autoScrolling&&this._processAutoScrolling(t)},i.onDisable=function(){this._unregisterEvent(),this._content&&(this._content.off(_t.SIZE_CHANGED,this._calculateBoundary,this),this._content.off(_t.TRANSFORM_CHANGED,this._scaleChanged,this),this.view&&(this.view.node.off(_t.TRANSFORM_CHANGED,this._scaleChanged,this),this.view.node.off(_t.SIZE_CHANGED,this._calculateBoundary,this))),this._hideScrollBar(),this.stopAutoScroll()},i._registerEvent=function(){this.node.on(_t.TOUCH_START,this._onTouchBegan,this,!0),this.node.on(_t.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.on(_t.TOUCH_END,this._onTouchEnded,this,!0),this.node.on(_t.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.on(_t.MOUSE_WHEEL,this._onMouseWheel,this,!0),this.node.on(pt.XRUI_HOVER_ENTERED,this._xrHoverEnter,this),this.node.on(pt.XRUI_HOVER_EXITED,this._xrHoverExit,this),ot.on(rt.EventType.HANDLE_INPUT,this._dispatchEventHandleInput,this),ot.on(rt.EventType.GAMEPAD_INPUT,this._dispatchEventHandleInput,this)},i._unregisterEvent=function(){this.node.off(_t.TOUCH_START,this._onTouchBegan,this,!0),this.node.off(_t.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.off(_t.TOUCH_END,this._onTouchEnded,this,!0),this.node.off(_t.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.off(_t.MOUSE_WHEEL,this._onMouseWheel,this,!0),this.node.off(pt.XRUI_HOVER_ENTERED,this._xrHoverEnter,this),this.node.off(pt.XRUI_HOVER_EXITED,this._xrHoverExit,this),ot.off(rt.EventType.HANDLE_INPUT,this._dispatchEventHandleInput,this),ot.off(rt.EventType.GAMEPAD_INPUT,this._dispatchEventHandleInput,this)},i._onMouseWheel=function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=new a,n=t.getScrollY();this.vertical?i.set(0,-.1*n,0):this.horizontal&&i.set(-.1*n,0,0),this._mouseWheelEventElapsedTime=0,this._processDeltaMove(i),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60,NaN,0),this._stopMouseWheel=!0),this._stopPropagationIfTargetIsMe(t)}},i._onTouchBegan=function(t,e){this.enabledInHierarchy&&this._content&&(this._hasNestedViewGroup(t,e)||(this._handlePressLogic(),this._touchMoved=!1,this._stopPropagationIfTargetIsMe(t)))},i._onTouchMoved=function(t,e){if(this.enabledInHierarchy&&this._content&&!this._hasNestedViewGroup(t,e)){var i=t.touch;if(this._handleMoveLogic(i),this.cancelInnerEvents){var n=i.getUILocation(kn);if(n.subtract(i.getUIStartLocation(Vn)),n.length()>7&&!this._touchMoved&&t.target!==this.node){var o=new vt(t.getTouches(),t.bubbles,mt.TOUCH_CANCEL);o.touch=t.touch,o.simulate=!0,t.target.dispatchEvent(o),this._touchMoved=!0}this._stopPropagationIfTargetIsMe(t)}}},i._onTouchEnded=function(t,e){if(this.enabledInHierarchy&&this._content&&t&&!this._hasNestedViewGroup(t,e)){this._dispatchEvent(Nn.TOUCH_UP);var i=t.touch;this._handleReleaseLogic(i),this._touchMoved?t.propagationStopped=!0:this._stopPropagationIfTargetIsMe(t)}},i._onTouchCancelled=function(t,e){if(this.enabledInHierarchy&&this._content&&!this._hasNestedViewGroup(t,e)){if(t&&!t.simulate){var i=t.touch;this._handleReleaseLogic(i)}this._stopPropagationIfTargetIsMe(t)}},i._calculateBoundary=function(){if(this._content&&this.view){var t=this._content.getComponent(Fi);t&&t.enabledInHierarchy&&t.updateLayout();var e=this.view,i=e.width*e.anchorX,n=e.height*e.anchorY;this._leftBoundary=-i,this._bottomBoundary=-n,this._rightBoundary=this._leftBoundary+e.width,this._topBoundary=this._bottomBoundary+e.height,this._moveContentToTopLeft(e.contentSize)}},i._hasNestedViewGroup=function(t,e){if(!t||t.eventPhase!==Ct.CAPTURING_PHASE)return!1;if(e)for(var i,n=x(e);!(i=n()).done;){var o=i.value;if(this.node===o)return!(!t.target||!t.target.getComponent(Pn));if(o.getComponent(Pn))return!0}return!1},i._startInertiaScroll=function(t){var e=new a(t);e.multiplyScalar(.7),this._startAttenuatingAutoScroll(e,t)},i._calculateAttenuatedFactor=function(t){return this.brake<=0?1-this.brake:(1-this.brake)*(1/(1+14e-6*t+t*t*8e-9))},i._startAttenuatingAutoScroll=function(t,e){var i=t.clone();if(i.normalize(),this._content&&this.view){var n=this._content._uiProps.uiTransformComp.contentSize,o=this.view.contentSize,r=n.width-o.width,s=n.height-o.height,a=this._calculateAttenuatedFactor(r),h=this._calculateAttenuatedFactor(s);i.x=i.x*r*(1-this.brake)*a,i.y=i.y*s*h*(1-this.brake),i.z=0}var c=t.length(),l=i.length()/c;if(i.add(t),this.brake>0&&l>7){l=Math.sqrt(l);var _=t.clone();_.multiplyScalar(l),i.set(_),i.add(t)}var u=this._calculateAutoScrollTimeByInitialSpeed(e.length());this.brake>0&&l>3&&(u*=l=3),0===this.brake&&l>1&&(u*=l),this._startAutoScroll(i,u,!0)},i._calculateAutoScrollTimeByInitialSpeed=function(t){return Math.sqrt(Math.sqrt(t/5))},i._startAutoScroll=function(t,e,i){void 0===i&&(i=!1);var n=this._flattenVectorByDirection(t);this._autoScrolling=!0,this._autoScrollTargetDelta=n,this._autoScrollAttenuate=i,a.copy(this._autoScrollStartPosition,this._getContentPosition()),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._isScrollEndedWithThresholdEventFired=!1,this._autoScrollBrakingStartPosition.set(0,0,0),this._getHowMuchOutOfBoundary().equals(a.ZERO,Hn)||(this._autoScrollCurrentlyOutOfBoundary=!0)},i._calculateTouchMoveVelocity=function(){var t=new a,e=0;if((e=this._touchMoveTimeDeltas.reduce((function(t,e){return t+e}),e))<=0||e>=.5)t.set(a.ZERO);else{var i=new a;i=this._touchMoveDisplacements.reduce((function(t,e){return t.add(e),t}),i),t.set(i.x*(1-this.brake)/e,i.y*(1-this.brake)/e,i.z)}return t},i._flattenVectorByDirection=function(t){var e=t;return e.x=this.horizontal?e.x:0,e.y=this.vertical?e.y:0,e},i._moveContent=function(t,e){var i=this._flattenVectorByDirection(t);Mn.set(this._getContentPosition()),Mn.add(i),Mn.set(Math.round(1e4*Mn.x)*Hn,Math.round(1e4*Mn.y)*Hn,Mn.z),this._setContentPosition(Mn);var n=this._getHowMuchOutOfBoundary();kn.set(n.x,n.y),this._updateScrollBar(kn),this.elastic&&e&&this._startBounceBackIfNeeded()},i._getContentLeftBoundary=function(){if(!this._content)return-1;var t=this._getContentPosition(),e=this._content._uiProps.uiTransformComp;return t.x-e.anchorX*e.width},i._getContentRightBoundary=function(){if(!this._content)return-1;var t=this._content._uiProps.uiTransformComp;return this._getContentLeftBoundary()+t.width},i._getContentTopBoundary=function(){if(!this._content)return-1;var t=this._content._uiProps.uiTransformComp;return this._getContentBottomBoundary()+t.height},i._getContentBottomBoundary=function(){if(!this._content)return-1;var t=this._getContentPosition(),e=this._content._uiProps.uiTransformComp;return t.y-e.anchorY*e.height},i._getHowMuchOutOfBoundary=function(t){if((t=t||new a).equals(a.ZERO,Hn)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=new a,i=this._getContentLeftBoundary(),n=this._getContentRightBoundary();i+t.x>this._leftBoundary?e.x=this._leftBoundary-(i+t.x):n+t.x<this._rightBoundary&&(e.x=this._rightBoundary-(n+t.x));var o=this._getContentTopBoundary(),r=this._getContentBottomBoundary();return o+t.y<this._topBoundary?e.y=this._topBoundary-(o+t.y):r+t.y>this._bottomBoundary&&(e.y=this._bottomBoundary-(r+t.y)),t.equals(a.ZERO,Hn)&&(this._outOfBoundaryAmount=e,this._outOfBoundaryAmountDirty=!1),this._clampDelta(e),e},i._updateScrollBar=function(t){this._horizontalScrollBar&&this._horizontalScrollBar.isValid&&this._horizontalScrollBar.onScroll(t),this._verticalScrollBar&&this._verticalScrollBar.isValid&&this._verticalScrollBar.onScroll(t)},i._onScrollBarTouchBegan=function(){this._horizontalScrollBar&&this._horizontalScrollBar.isValid&&this._horizontalScrollBar.onTouchBegan(),this._verticalScrollBar&&this._verticalScrollBar.isValid&&this._verticalScrollBar.onTouchBegan()},i._onScrollBarTouchEnded=function(){this._horizontalScrollBar&&this._horizontalScrollBar.isValid&&this._horizontalScrollBar.onTouchEnded(),this._verticalScrollBar&&this._verticalScrollBar.isValid&&this._verticalScrollBar.onTouchEnded()},i._dispatchEvent=function(t){if(t===Nn.SCROLL_ENDED)this._scrollEventEmitMask=0;else if(t===Nn.SCROLL_TO_TOP||t===Nn.SCROLL_TO_BOTTOM||t===Nn.SCROLL_TO_LEFT||t===Nn.SCROLL_TO_RIGHT){var e=1<<Un[t];if(this._scrollEventEmitMask&e)return;this._scrollEventEmitMask|=e}ut.emitEvents(this.scrollEvents,this,Un[t]),this.node.emit(t,this)},i._adjustContentOutOfBoundary=function(){if(this._content&&(this._outOfBoundaryAmountDirty=!0,this._isOutOfBoundary())){var t=this._getHowMuchOutOfBoundary();Mn.set(this._getContentPosition()),Mn.add(t),this._setContentPosition(Mn),this._updateScrollBar(I.ZERO)}},i._hideScrollBar=function(){this._horizontalScrollBar&&this._horizontalScrollBar.isValid&&this._horizontalScrollBar.hide(),this._verticalScrollBar&&this._verticalScrollBar.isValid&&this._verticalScrollBar.hide()},i._updateScrollBarState=function(){if(this._content&&this.view){var t=this.view,e=this._content._uiProps.uiTransformComp;this._verticalScrollBar&&this._verticalScrollBar.isValid&&(e.height<t.height?this._verticalScrollBar.hide():this._verticalScrollBar.show()),this._horizontalScrollBar&&this._horizontalScrollBar.isValid&&(e.width<t.width?this._horizontalScrollBar.hide():this._horizontalScrollBar.show())}},i._stopPropagationIfTargetIsMe=function(t){t.eventPhase===Ct.AT_TARGET&&t.target===this.node&&(t.propagationStopped=!0)},i._processDeltaMove=function(t){this._scrollChildren(t),this._gatherTouchMove(t)},i._handleMoveLogic=function(t){this._getLocalAxisAlignDelta(this._deltaPos,t),this._processDeltaMove(this._deltaPos)},i._handleReleaseLogic=function(t){this._getLocalAxisAlignDelta(this._deltaPos,t),this._gatherTouchMove(this._deltaPos),this._processInertiaScroll(),this._scrolling&&(this._scrolling=!1,this._autoScrolling||this._dispatchEvent(Nn.SCROLL_ENDED))},i._getLocalAxisAlignDelta=function(t,e){var i=this.node._uiProps.uiTransformComp,n=new a;i&&(e.getUILocation(kn),e.getUIPreviousLocation(Vn),Mn.set(kn.x,kn.y,0),zn.set(Vn.x,Vn.y,0),i.convertToNodeSpaceAR(Mn,Mn),i.convertToNodeSpaceAR(zn,zn),a.subtract(n,Mn,zn)),t.set(n)},i._scrollChildren=function(t){this._clampDelta(t);var e,i=t;this.elastic&&(e=this._getHowMuchOutOfBoundary(),i.x*=0===e.x?1:.5,i.y*=0===e.y?1:.5),this.elastic||(e=this._getHowMuchOutOfBoundary(i),i.add(e));var n="",o="";if(this._content){var r=this._content._uiProps.uiTransformComp,s=r.anchorX,h=r.anchorY,c=r.width,l=r.height,_=this._content.position||a.ZERO;this.vertical&&(i.y>0?_.y-h*l+i.y>=this._bottomBoundary&&(n=Nn.SCROLL_TO_BOTTOM):i.y<0&&_.y-h*l+l+i.y<=this._topBoundary&&(n=Nn.SCROLL_TO_TOP)),this.horizontal&&(i.x<0?_.x-s*c+c+i.x<=this._rightBoundary&&(o=Nn.SCROLL_TO_RIGHT):i.x>0&&_.x-s*c+i.x>=this._leftBoundary&&(o=Nn.SCROLL_TO_LEFT))}this._moveContent(i,!1),(this.horizontal&&0!==i.x||this.vertical&&0!==i.y)&&(this._scrolling||(this._scrolling=!0,this._dispatchEvent(Nn.SCROLL_BEGAN)),this._dispatchEvent(Nn.SCROLLING)),""!==n&&this._dispatchEvent(n),""!==o&&this._dispatchEvent(o)},i._handlePressLogic=function(){this._autoScrolling&&this._dispatchEvent(Nn.SCROLL_ENDED),this._autoScrolling=!1,this._isBouncing=!1,this._touchMovePreviousTimestamp=Fn(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._onScrollBarTouchBegan()},i._clampDelta=function(t){if(this._content&&this.view){var e=this.view.contentSize,i=this._content._uiProps.uiTransformComp;i.width<e.width&&(t.x=0),i.height<e.height&&(t.y=0)}},i._gatherTouchMove=function(t){var e=t.clone();for(this._clampDelta(e);this._touchMoveDisplacements.length>=5;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(e);var i=Fn();this._touchMoveTimeDeltas.push((i-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=i},i._startBounceBackIfNeeded=function(){if(!this.elastic)return!1;var t=this._getHowMuchOutOfBoundary();if(this._clampDelta(t),t.equals(a.ZERO,Hn))return!1;var e=Math.max(this.bounceDuration,0);return this._startAutoScroll(t,e,!0),this._isBouncing||(t.y>0&&this._dispatchEvent(Nn.BOUNCE_TOP),t.y<0&&this._dispatchEvent(Nn.BOUNCE_BOTTOM),t.x>0&&this._dispatchEvent(Nn.BOUNCE_RIGHT),t.x<0&&this._dispatchEvent(Nn.BOUNCE_LEFT),this._isBouncing=!0),!0},i._processInertiaScroll=function(){if(!this._startBounceBackIfNeeded()&&this.inertia){var t=this._calculateTouchMoveVelocity();!t.equals(Mn,Hn)&&this.brake<1&&this._startInertiaScroll(t)}this._onScrollBarTouchEnded()},i._isOutOfBoundary=function(){return!this._getHowMuchOutOfBoundary().equals(a.ZERO,Hn)},i._isNecessaryAutoScrollBrake=function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,a.copy(this._autoScrollBrakingStartPosition,this._getContentPosition()),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},i._processAutoScrolling=function(t){var e=this._isNecessaryAutoScrollBrake(),i=e?.05:1;this._autoScrollAccumulatedTime+=t*(1/i);var n,o=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(n=o,o=(n-=1)*n*n*n*n+1);var r=this._autoScrollTargetDelta.clone();r.multiplyScalar(o);var s=this._autoScrollStartPosition.clone();s.add(r);var h=Math.abs(o-1)<=Hn;if(Math.abs(o-1)<=this.getScrollEndedEventTiming()&&!this._isScrollEndedWithThresholdEventFired&&(this._dispatchEvent(Nn.SCROLL_ENG_WITH_THRESHOLD),this._isScrollEndedWithThresholdEventFired=!0),this.elastic){var c=s.clone();c.subtract(this._autoScrollBrakingStartPosition),e&&c.multiplyScalar(i),s.set(this._autoScrollBrakingStartPosition),s.add(c)}else{var l=s.clone();l.subtract(this.getContentPosition());var _=this._getHowMuchOutOfBoundary(l);_.equals(a.ZERO,Hn)||(s.add(_),h=!0)}h&&(this._autoScrolling=!1);var u=s.clone();u.subtract(this._getContentPosition()),this._clampDelta(u),this._moveContent(u,h),this._dispatchEvent(Nn.SCROLLING),this._autoScrolling||(this._isBouncing=!1,this._scrolling=!1,this._dispatchEvent(Nn.SCROLL_ENDED))},i._checkMouseWheel=function(t){if(!this._getHowMuchOutOfBoundary().equals(a.ZERO,Hn))return this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),this._dispatchEvent(Nn.SCROLL_ENDED),void(this._stopMouseWheel=!1);this._mouseWheelEventElapsedTime+=t,this._mouseWheelEventElapsedTime>.1&&(this._onScrollBarTouchEnded(),this.unschedule(this._checkMouseWheel),this._dispatchEvent(Nn.SCROLL_ENDED),this._stopMouseWheel=!1)},i._calculateMovePercentDelta=function(t){var e=t.anchor,i=t.applyToHorizontal,n=t.applyToVertical;this._calculateBoundary(),e.clampf(I.ZERO,I.ONE);var o=this._getContentBottomBoundary()-this._bottomBoundary;o=-o;var r=this._getContentLeftBoundary()-this._leftBoundary;r=-r;var s=new a;if(this._content&&this.view){var h=0,c=this._content._uiProps.uiTransformComp.contentSize,l=this.view.contentSize;i&&(h=c.width-l.width,s.x=r-h*e.x),n&&(h=c.height-l.height,s.y=o-h*e.y)}return s},i._moveContentToTopLeft=function(t){var e=this._getContentBottomBoundary()-this._bottomBoundary;e=-e;var i=new a,n=0,o=this._getContentLeftBoundary()-this._leftBoundary;if(o=-o,this._content){var r=this._content._uiProps.uiTransformComp.contentSize;r.height<t.height&&(n=r.height-t.height,i.y=e-n),r.width<t.width&&(n=r.width-t.width,i.x=o)}this._updateScrollBarState(),this._moveContent(i),this._adjustContentOutOfBoundary()},i._scaleChanged=function(t){t===st.SCALE&&this._calculateBoundary()},i._xrHoverEnter=function(t){t.deviceType===ft.Left?this._hoverIn=Bn.LEFT:t.deviceType===ft.Right&&(this._hoverIn=Bn.RIGHT)},i._xrHoverExit=function(){this._hoverIn=Bn.NONE},i._dispatchEventHandleInput=function(t){var e,i;t instanceof St?e=t.gamepad:t instanceof Et&&(e=t.handleInputDevice),this.enabledInHierarchy&&this._hoverIn!==Bn.NONE&&(this._hoverIn===Bn.LEFT?(i=e.leftStick.getValue()).equals(I.ZERO)||this._xrThumbStickMove(i):this._hoverIn===Bn.RIGHT&&((i=e.rightStick.getValue()).equals(I.ZERO)||this._xrThumbStickMove(i)))},i._xrThumbStickMove=function(t){if(this.enabledInHierarchy){var e=new a,i=t.y;this.vertical?e.set(0,-62.5*i,0):this.horizontal&&e.set(-62.5*i,0,0),this._mouseWheelEventElapsedTime=0,this._processDeltaMove(e),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60,NaN,0),this._stopMouseWheel=!0)}},h(e,[{key:"content",get:function(){return this._content},set:function(t){if(this._content!==t){var e=t&&t.parent&&t.parent._uiProps.uiTransformComp;!t||t&&e?(this._content=t,this._calculateBoundary()):w(4302)}}},{key:"horizontalScrollBar",get:function(){return this._horizontalScrollBar&&!this._horizontalScrollBar.isValid&&P(4303,"horizontal",this.node.name),this._horizontalScrollBar},set:function(t){this._horizontalScrollBar!==t&&(this._horizontalScrollBar=t,this._horizontalScrollBar&&(this._horizontalScrollBar.setScrollView(this),this._updateScrollBar(I.ZERO)))}},{key:"verticalScrollBar",get:function(){return this._verticalScrollBar&&!this._verticalScrollBar.isValid&&P(4303,"vertical",this.node.name),this._verticalScrollBar},set:function(t){this._verticalScrollBar!==t&&(this._verticalScrollBar=t,this._verticalScrollBar&&(this._verticalScrollBar.setScrollView(this),this._updateScrollBar(I.ZERO)))}},{key:"view",get:function(){var t=this._content&&this._content.parent;return t?t._uiProps.uiTransformComp:null}}]),e}(Pn)).EventType=Nn,Cn=l((mn=wn).prototype,"bounceDuration",[p],(function(){return 1})),Sn=l(mn.prototype,"brake",[p],(function(){return.5})),En=l(mn.prototype,"elastic",[p],(function(){return!0})),Ln=l(mn.prototype,"inertia",[p],(function(){return!0})),c(mn.prototype,"content",[gn],Object.getOwnPropertyDescriptor(mn.prototype,"content"),mn.prototype),An=l(mn.prototype,"horizontal",[p],(function(){return!0})),c(mn.prototype,"horizontalScrollBar",[fn],Object.getOwnPropertyDescriptor(mn.prototype,"horizontalScrollBar"),mn.prototype),On=l(mn.prototype,"vertical",[p],(function(){return!0})),c(mn.prototype,"verticalScrollBar",[yn],Object.getOwnPropertyDescriptor(mn.prototype,"verticalScrollBar"),mn.prototype),bn=l(mn.prototype,"cancelInnerEvents",[p],(function(){return!0})),Dn=l(mn.prototype,"scrollEvents",[Tn,p],(function(){return[]})),In=l(mn.prototype,"_content",[p],(function(){return null})),Rn=l(mn.prototype,"_horizontalScrollBar",[p],(function(){return null})),xn=l(mn.prototype,"_verticalScrollBar",[p],(function(){return null})),vn=mn))||vn)||vn)||vn);t({ScrollView:io,ScrollViewComponent:io}),_.ScrollView=io;var no,oo=new a;!function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(no||(no={})),i(no);var ro,so,ao,ho,co,lo,_o,uo,po,go,fo,yo,To=(Gn=n("cc.Slider"),Wn=u(110),jn=d(Y),Zn=o(J),Xn=o(no),Yn=o([ut]),Gn(Kn=Wn(Kn=jn(((eo=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).slideEvents=Qn&&Qn(),e._handle=Jn&&Jn(),e._direction=$n&&$n(),e._progress=to&&to(),e._offset=new a,e._dragging=!1,e._touchHandle=!1,e._handleLocalPos=new a,e._touchPos=new a,e}r(e,t);var i=e.prototype;return i.__preload=function(){this._updateHandlePosition()},i.onEnable=function(){this._updateHandlePosition(),this.node.on(_t.TOUCH_START,this._onTouchBegan,this),this.node.on(_t.TOUCH_MOVE,this._onTouchMoved,this),this.node.on(_t.TOUCH_END,this._onTouchEnded,this),this.node.on(_t.TOUCH_CANCEL,this._onTouchCancelled,this),this.node.on(pt.XRUI_HOVER_STAY,this._xrHoverStay,this),this.node.on(pt.XRUI_CLICK,this._xrClick,this),this.node.on(pt.XRUI_UNCLICK,this._xrUnClick,this),this._handle&&this._handle.isValid&&(this._handle.node.on(_t.TOUCH_START,this._onHandleDragStart,this),this._handle.node.on(_t.TOUCH_MOVE,this._onTouchMoved,this),this._handle.node.on(_t.TOUCH_END,this._onTouchEnded,this))},i.onDisable=function(){this.node.off(_t.TOUCH_START,this._onTouchBegan,this),this.node.off(_t.TOUCH_MOVE,this._onTouchMoved,this),this.node.off(_t.TOUCH_END,this._onTouchEnded,this),this.node.off(_t.TOUCH_CANCEL,this._onTouchCancelled,this),this.node.off(pt.XRUI_HOVER_STAY,this._xrHoverStay,this),this.node.off(pt.XRUI_CLICK,this._xrClick,this),this.node.off(pt.XRUI_UNCLICK,this._xrUnClick,this),this._handle&&this._handle.isValid&&(this._handle.node.off(_t.TOUCH_START,this._onHandleDragStart,this),this._handle.node.off(_t.TOUCH_MOVE,this._onTouchMoved,this),this._handle.node.off(_t.TOUCH_END,this._onTouchEnded,this))},i._onHandleDragStart=function(t){if(t&&this._handle&&this._handle.node._uiProps.uiTransformComp){this._dragging=!0,this._touchHandle=!0;var e=t.touch.getUILocation();a.set(this._touchPos,e.x,e.y,0),this._handle.node._uiProps.uiTransformComp.convertToNodeSpaceAR(this._touchPos,this._offset),t.propagationStopped=!0}},i._onTouchBegan=function(t){this._handle&&t&&(this._dragging=!0,this._touchHandle||this._handleSliderLogic(t.touch),t.propagationStopped=!0)},i._onTouchMoved=function(t){this._dragging&&t&&(this._handleSliderLogic(t.touch),t.propagationStopped=!0)},i._onTouchEnded=function(t){this._dragging=!1,this._touchHandle=!1,this._offset=new a,t&&(t.propagationStopped=!0)},i._onTouchCancelled=function(t){this._dragging=!1,t&&(t.propagationStopped=!0)},i._handleSliderLogic=function(t){this._updateProgress(t),this._emitSlideEvent()},i._emitSlideEvent=function(){ut.emitEvents(this.slideEvents,this),this.node.emit("slide",this)},i._updateProgress=function(t){if(this._handle&&t){var e=t.getUILocation();a.set(this._touchPos,e.x,e.y,0);var i=this.node._uiProps.uiTransformComp,n=i.convertToNodeSpaceAR(this._touchPos,oo);this.direction===no.Horizontal?this.progress=R(.5+(n.x-this._offset.x)/i.width):this.progress=R(.5+(n.y-this._offset.y)/i.height)}},i._updateHandlePosition=function(){if(this._handle){this._handleLocalPos.set(this._handle.node.getPosition());var t=this.node._uiProps.uiTransformComp;this._direction===no.Horizontal?this._handleLocalPos.x=-t.width*t.anchorX+this.progress*t.width:this._handleLocalPos.y=-t.height*t.anchorY+this.progress*t.height,this._handle.node.setPosition(this._handleLocalPos)}},i._changeLayout=function(){var t=this.node._uiProps.uiTransformComp,e=t.contentSize;if(t.setContentSize(e.height,e.width),this._handle){var i=this._handle.node.position;this._direction===no.Horizontal?this._handle.node.setPosition(i.x,0,i.z):this._handle.node.setPosition(0,i.y,i.z),this._updateHandlePosition()}},i._xrHandleProgress=function(t){if(!this._touchHandle){var e=this.node._uiProps.uiTransformComp;e.convertToNodeSpaceAR(t,oo),this.direction===no.Horizontal?this.progress=R(.5+(oo.x-this.node.position.x)/e.width):this.progress=R(.5+(oo.y-this.node.position.y)/e.height)}},i._xrClick=function(t){this._handle&&(this._dragging=!0,this._xrHandleProgress(t.hitPoint),this._emitSlideEvent())},i._xrUnClick=function(){this._dragging=!1,this._touchHandle=!1},i._xrHoverStay=function(t){this._dragging&&(this._xrHandleProgress(t.hitPoint),this._emitSlideEvent())},h(e,[{key:"handle",get:function(){return this._handle},set:function(t){this._handle!==t&&(this._handle=t)}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction!==t&&(this._direction=t,this._changeLayout())}},{key:"progress",get:function(){return this._progress},set:function(t){this._progress!==t&&(this._progress=t,this._updateHandlePosition())}}]),e}(dt)).Direction=no,c((qn=eo).prototype,"handle",[Zn],Object.getOwnPropertyDescriptor(qn.prototype,"handle"),qn.prototype),c(qn.prototype,"direction",[Xn],Object.getOwnPropertyDescriptor(qn.prototype,"direction"),qn.prototype),Qn=l(qn.prototype,"slideEvents",[Yn,p],(function(){return[]})),Jn=l(qn.prototype,"_handle",[p],(function(){return null})),$n=l(qn.prototype,"_direction",[p],(function(){return no.Horizontal})),to=l(qn.prototype,"_progress",[p],(function(){return.1})),Kn=qn))||Kn)||Kn)||Kn);function vo(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return Object.assign.apply(Object,[{}].concat(e))}t({Slider:To,SliderComponent:To}),_.Slider=To,function(t){t.TOGGLE="toggle"}(yo||(yo={}));var mo,Co,So,Eo,Lo,Ao,Oo,bo=(ro=n("cc.Toggle"),so=u(110),ao=d(Y),ho=o(J),co=o([ut]),ro(lo=so(lo=ao(((fo=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).checkEvents=uo&&uo(),e._isChecked=po&&po(),e._checkMark=go&&go(),e}r(e,t);var i=e.prototype;return i._internalToggle=function(){this.isChecked=!this.isChecked},i._set=function(t,e){if(void 0===e&&(e=!0),this._isChecked!=t){this._isChecked=t;var i=this._toggleContainer;i&&i.enabled&&this.enabled&&(t||!i.anyTogglesChecked()&&!i.allowSwitchOff)&&(this._isChecked=!0,i.notifyToggleCheck(this,e)),this.playEffect(),e&&this._emitToggleEvents()}},i.playEffect=function(){this._checkMark&&(this._checkMark.node.active=this._isChecked)},i.setIsCheckedWithoutNotify=function(t){this._set(t,!1)},i.onEnable=function(){t.prototype.onEnable.call(this),this.playEffect(),this.node.on(e.EventType.CLICK,this._internalToggle,this)},i.onDisable=function(){t.prototype.onDisable.call(this),this.node.off(e.EventType.CLICK,this._internalToggle,this)},i._emitToggleEvents=function(){this.node.emit(e.EventType.TOGGLE,this),this.checkEvents&&ut.emitEvents(this.checkEvents,this)},h(e,[{key:"isChecked",get:function(){return this._isChecked},set:function(t){this._set(t)}},{key:"checkMark",get:function(){return this._checkMark},set:function(t){this._checkMark!==t&&(this._checkMark=t)}},{key:"_resizeToTarget",set:function(t){t&&this._resizeNodeToTargetNode()}},{key:"_toggleContainer",get:function(){var t=this.node.parent;return _.Node.isNode(t)?t.getComponent("cc.ToggleContainer"):null}}]),e}(ie)).EventType=vo(yo,te),c((_o=fo).prototype,"checkMark",[ho],Object.getOwnPropertyDescriptor(_o.prototype,"checkMark"),_o.prototype),uo=l(_o.prototype,"checkEvents",[co,p],(function(){return[]})),po=l(_o.prototype,"_isChecked",[p],(function(){return!0})),go=l(_o.prototype,"_checkMark",[p],(function(){return null})),lo=_o))||lo)||lo)||lo);t({Toggle:bo,ToggleComponent:bo}),_.Toggle=bo;var Do,Io,Ro,xo,wo,Po,No,Bo,Ho,Mo,zo,ko,Vo,Fo,Uo,Go,Wo,jo,Zo,Xo,Yo,Ko,qo,Qo,Jo,$o,tr=(mo=n("cc.ToggleContainer"),Co=u(110),So=o([ut]),mo(Eo=Co((Lo=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this)._allowSwitchOff=Ao&&Ao(),e.checkEvents=Oo&&Oo(),e}r(e,t);var i=e.prototype;return i.onEnable=function(){this.ensureValidState(),this.node.on(_t.CHILD_ADDED,this.ensureValidState,this),this.node.on(_t.CHILD_REMOVED,this.ensureValidState,this)},i.onDisable=function(){this.node.off(_t.CHILD_ADDED,this.ensureValidState,this),this.node.off(_t.CHILD_REMOVED,this.ensureValidState,this)},i.activeToggles=function(){return this.toggleItems.filter((function(t){return t.isChecked}))},i.anyTogglesChecked=function(){return!!this.toggleItems.find((function(t){return t.isChecked}))},i.notifyToggleCheck=function(t,e){if(void 0===e&&(e=!0),this.enabledInHierarchy){for(var i=0;i<this.toggleItems.length;i++){var n=this.toggleItems[i];n!==t&&(e?n.isChecked=!1:n.setIsCheckedWithoutNotify(!1))}this.checkEvents&&_.Component.EventHandler.emitEvents(this.checkEvents,t)}},i.ensureValidState=function(){var t=this.toggleItems;if(!this._allowSwitchOff&&!this.anyTogglesChecked()&&0!==t.length){var e=t[0];e.isChecked=!0,this.notifyToggleCheck(e)}var i=this.activeToggles();if(i.length>1)for(var n=i[0],o=0;o<i.length;++o){var r=i[o];r!==n&&(r.isChecked=!1)}},h(e,[{key:"allowSwitchOff",get:function(){return this._allowSwitchOff},set:function(t){this._allowSwitchOff=t}},{key:"toggleItems",get:function(){return this.node.children.map((function(t){var e=t.getComponent("cc.Toggle");return e&&e.enabled?e:null})).filter(Boolean)}}]),e}(dt),Ao=l(Lo.prototype,"_allowSwitchOff",[p],(function(){return!1})),Oo=l(Lo.prototype,"checkEvents",[So,p],(function(){return[]})),Eo=Lo))||Eo)||Eo);t({ToggleContainer:tr,ToggleContainerComponent:tr}),_.ToggleContainer=tr;var er,ir,nr=new I;function or(t){return t instanceof ht?E:t._uiProps.uiTransformComp?t._uiProps.uiTransformComp.contentSize:b.ZERO}function rr(t,e,i,n){t.parent?nr.set(t.parent.getScale().x,t.parent.getScale().y):nr.set(0,0);for(var o=nr.x,r=nr.y,s=0,a=0,h=t.parent;;){if(!h)return i.x=i.y=0,void(n.x=n.y=1);var c=h.getPosition();if(s+=c.x,a+=c.y,(h=h.parent)===e)break;h?nr.set(h.getScale().x,h.getScale().y):nr.set(0,0);var l=nr.x,_=nr.y;s*=l,a*=_,o*=l,r*=_}n.x=0!==o?1/o:1,n.y=0!==r?1/r:1,i.x=-s,i.y=-a}!function(t){t[t.ONCE=0]="ONCE",t[t.ALWAYS=1]="ALWAYS",t[t.ON_WINDOW_RESIZE=2]="ON_WINDOW_RESIZE"}(er||(er={})),i(er),function(t){t[t.TOP=1]="TOP",t[t.MID=2]="MID",t[t.BOT=4]="BOT",t[t.LEFT=8]="LEFT",t[t.CENTER=16]="CENTER",t[t.RIGHT=32]="RIGHT",t[t.HORIZONTAL=56]="HORIZONTAL",t[t.VERTICAL=7]="VERTICAL"}(ir||(ir={}));var sr,ar,hr,cr,lr,_r,ur,dr,pr,gr,fr,yr,Tr=ir.TOP|ir.BOT,vr=ir.LEFT|ir.RIGHT,mr=(Do=n("cc.Widget"),Io=u(110),Ro=d(Y),xo=o(at),wo=o(er),Do(Po=Io(Po=Ro((($o=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this)._lastPos=new a,e._lastSize=new b,e._dirty=!0,e._hadAlignOnce=!1,e._alignFlags=Bo&&Bo(),e._target=Ho&&Ho(),e._left=Mo&&Mo(),e._right=zo&&zo(),e._top=ko&&ko(),e._bottom=Vo&&Vo(),e._horizontalCenter=Fo&&Fo(),e._verticalCenter=Uo&&Uo(),e._isAbsLeft=Go&&Go(),e._isAbsRight=Wo&&Wo(),e._isAbsTop=jo&&jo(),e._isAbsBottom=Zo&&Zo(),e._isAbsHorizontalCenter=Xo&&Xo(),e._isAbsVerticalCenter=Yo&&Yo(),e._originalWidth=Ko&&Ko(),e._originalHeight=qo&&qo(),e._alignMode=Qo&&Qo(),e._lockFlags=Jo&&Jo(),e}r(e,t);var i=e.prototype;return i.updateAlignment=function(){_._widgetManager.updateAlignment(this.node)},i._validateTargetInDEV=function(){},i.setDirty=function(){this._recursiveDirty()},i.onEnable=function(){this.node.getPosition(this._lastPos),this._lastSize.set(this.node._uiProps.uiTransformComp.contentSize),_._widgetManager.add(this),this._hadAlignOnce=!1,this._registerEvent(),this._registerTargetEvents()},i.onDisable=function(){_._widgetManager.remove(this),this._unregisterEvent(),this._unregisterTargetEvents()},i.onDestroy=function(){this._removeParentEvent()},i._adjustWidgetToAllowMovingInEditor=function(){},i._adjustWidgetToAllowResizingInEditor=function(){},i._adjustWidgetToAnchorChanged=function(){this.setDirty()},i._adjustTargetToParentChanged=function(t){t&&this._unregisterOldParentEvents(t),this.node.getParent()&&this._registerTargetEvents(),this._setDirtyByMode()},i._registerEvent=function(){this.node.on(_t.TRANSFORM_CHANGED,this._setDirtyByMode,this),this.node.on(_t.SIZE_CHANGED,this._setDirtyByMode,this),this.node.on(_t.ANCHOR_CHANGED,this._adjustWidgetToAnchorChanged,this),this.node.on(_t.PARENT_CHANGED,this._adjustTargetToParentChanged,this)},i._unregisterEvent=function(){this.node.off(_t.TRANSFORM_CHANGED,this._setDirtyByMode,this),this.node.off(_t.SIZE_CHANGED,this._setDirtyByMode,this),this.node.off(_t.ANCHOR_CHANGED,this._adjustWidgetToAnchorChanged,this)},i._removeParentEvent=function(){this.node.off(_t.PARENT_CHANGED,this._adjustTargetToParentChanged,this)},i._autoChangedValue=function(t,e){if((this._alignFlags&t)>0){var i=this.node.parent&&this.node.parent._uiProps,n=i&&i.uiTransformComp,o=n?n.contentSize:E;this.isAlignLeft&&t===ir.LEFT?this._left=e?this._left*o.width:this._left/o.width:this.isAlignRight&&t===ir.RIGHT?this._right=e?this._right*o.width:this._right/o.width:this.isAlignHorizontalCenter&&t===ir.CENTER?this._horizontalCenter=e?this._horizontalCenter*o.width:this._horizontalCenter/o.width:this.isAlignTop&&t===ir.TOP?this._top=e?this._top*o.height:this._top/o.height:this.isAlignBottom&&t===ir.BOT?this._bottom=e?this._bottom*o.height:this._bottom/o.height:this.isAbsoluteVerticalCenter&&t===ir.MID&&(this._verticalCenter=this._verticalCenter/o.height),this._recursiveDirty()}},i._registerTargetEvents=function(){var t=this._target||this.node.parent;t&&t.getComponent(Y)&&(t.on(_t.TRANSFORM_CHANGED,this._setDirtyByMode,this),t.on(_t.SIZE_CHANGED,this._setDirtyByMode,this),t.on(_t.ANCHOR_CHANGED,this._setDirtyByMode,this))},i._unregisterTargetEvents=function(){var t=this._target||this.node.parent;t&&(t.off(_t.TRANSFORM_CHANGED,this._setDirtyByMode,this),t.off(_t.SIZE_CHANGED,this._setDirtyByMode,this),t.off(_t.ANCHOR_CHANGED,this._setDirtyByMode,this))},i._unregisterOldParentEvents=function(t){var e=this._target||t;e&&(e.off(_t.TRANSFORM_CHANGED,this._setDirtyByMode,this),e.off(_t.SIZE_CHANGED,this._setDirtyByMode,this))},i._setDirtyByMode=function(){(this.alignMode===er.ALWAYS||N)&&this._recursiveDirty()},i._setAlign=function(t,e){if(e!==(this._alignFlags&t)>0){var i=(t&vr)>0,n=this.node._uiProps.uiTransformComp;e?(this._alignFlags|=t,i?(this.isAlignHorizontalCenter=!1,this.isStretchWidth&&(this._originalWidth=n.width)):(this.isAlignVerticalCenter=!1,this.isStretchHeight&&(this._originalHeight=n.height))):(i?this.isStretchWidth&&(n.width=this._originalWidth):this.isStretchHeight&&(n.height=this._originalHeight),this._alignFlags&=~t)}},i._recursiveDirty=function(){this._dirty||(this._dirty=!0)},h(e,[{key:"target",get:function(){return this._target},set:function(t){this._target!==t&&(this._unregisterTargetEvents(),this._target=t,this._registerTargetEvents(),this._validateTargetInDEV(),this._recursiveDirty())}},{key:"isAlignTop",get:function(){return(this._alignFlags&ir.TOP)>0},set:function(t){this._setAlign(ir.TOP,t),this._recursiveDirty()}},{key:"isAlignBottom",get:function(){return(this._alignFlags&ir.BOT)>0},set:function(t){this._setAlign(ir.BOT,t),this._recursiveDirty()}},{key:"isAlignLeft",get:function(){return(this._alignFlags&ir.LEFT)>0},set:function(t){this._setAlign(ir.LEFT,t),this._recursiveDirty()}},{key:"isAlignRight",get:function(){return(this._alignFlags&ir.RIGHT)>0},set:function(t){this._setAlign(ir.RIGHT,t),this._recursiveDirty()}},{key:"isAlignVerticalCenter",get:function(){return(this._alignFlags&ir.MID)>0},set:function(t){t?(this.isAlignTop=!1,this.isAlignBottom=!1,this._alignFlags|=ir.MID):this._alignFlags&=~ir.MID,this._recursiveDirty()}},{key:"isAlignHorizontalCenter",get:function(){return(this._alignFlags&ir.CENTER)>0},set:function(t){t?(this.isAlignLeft=!1,this.isAlignRight=!1,this._alignFlags|=ir.CENTER):this._alignFlags&=~ir.CENTER,this._recursiveDirty()}},{key:"isStretchWidth",get:function(){return(this._alignFlags&vr)===vr}},{key:"isStretchHeight",get:function(){return(this._alignFlags&Tr)===Tr}},{key:"top",get:function(){return this._top},set:function(t){this._top=t,this._recursiveDirty()}},{key:"editorTop",get:function(){return this._isAbsTop?this._top:100*this._top},set:function(t){this._top=this._isAbsTop?t:t/100,this._recursiveDirty()}},{key:"bottom",get:function(){return this._bottom},set:function(t){this._bottom=t,this._recursiveDirty()}},{key:"editorBottom",get:function(){return this._isAbsBottom?this._bottom:100*this._bottom},set:function(t){this._bottom=this._isAbsBottom?t:t/100,this._recursiveDirty()}},{key:"left",get:function(){return this._left},set:function(t){this._left=t,this._recursiveDirty()}},{key:"editorLeft",get:function(){return this._isAbsLeft?this._left:100*this._left},set:function(t){this._left=this._isAbsLeft?t:t/100,this._recursiveDirty()}},{key:"right",get:function(){return this._right},set:function(t){this._right=t,this._recursiveDirty()}},{key:"editorRight",get:function(){return this._isAbsRight?this._right:100*this._right},set:function(t){this._right=this._isAbsRight?t:t/100,this._recursiveDirty()}},{key:"horizontalCenter",get:function(){return this._horizontalCenter},set:function(t){this._horizontalCenter=t,this._recursiveDirty()}},{key:"editorHorizontalCenter",get:function(){return this._isAbsHorizontalCenter?this._horizontalCenter:100*this._horizontalCenter},set:function(t){this._horizontalCenter=this._isAbsHorizontalCenter?t:t/100,this._recursiveDirty()}},{key:"verticalCenter",get:function(){return this._verticalCenter},set:function(t){this._verticalCenter=t,this._recursiveDirty()}},{key:"editorVerticalCenter",get:function(){return this._isAbsVerticalCenter?this._verticalCenter:100*this._verticalCenter},set:function(t){this._verticalCenter=this._isAbsVerticalCenter?t:t/100,this._recursiveDirty()}},{key:"isAbsoluteTop",get:function(){return this._isAbsTop},set:function(t){this._isAbsTop!==t&&(this._isAbsTop=t,this._autoChangedValue(ir.TOP,this._isAbsTop))}},{key:"isAbsoluteBottom",get:function(){return this._isAbsBottom},set:function(t){this._isAbsBottom!==t&&(this._isAbsBottom=t,this._autoChangedValue(ir.BOT,this._isAbsBottom))}},{key:"isAbsoluteLeft",get:function(){return this._isAbsLeft},set:function(t){this._isAbsLeft!==t&&(this._isAbsLeft=t,this._autoChangedValue(ir.LEFT,this._isAbsLeft))}},{key:"isAbsoluteRight",get:function(){return this._isAbsRight},set:function(t){this._isAbsRight!==t&&(this._isAbsRight=t,this._autoChangedValue(ir.RIGHT,this._isAbsRight))}},{key:"isAbsoluteHorizontalCenter",get:function(){return this._isAbsHorizontalCenter},set:function(t){this._isAbsHorizontalCenter!==t&&(this._isAbsHorizontalCenter=t,this._autoChangedValue(ir.CENTER,this._isAbsHorizontalCenter))}},{key:"isAbsoluteVerticalCenter",get:function(){return this._isAbsVerticalCenter},set:function(t){this._isAbsVerticalCenter!==t&&(this._isAbsVerticalCenter=t,this._autoChangedValue(ir.MID,this._isAbsVerticalCenter))}},{key:"alignMode",get:function(){return this._alignMode},set:function(t){this._alignMode=t,this._recursiveDirty()}},{key:"alignFlags",get:function(){return this._alignFlags},set:function(t){this._alignFlags!==t&&(this._alignFlags=t,this._recursiveDirty())}}]),e}(dt)).AlignMode=er,c((No=$o).prototype,"target",[xo],Object.getOwnPropertyDescriptor(No.prototype,"target"),No.prototype),c(No.prototype,"alignMode",[wo],Object.getOwnPropertyDescriptor(No.prototype,"alignMode"),No.prototype),Bo=l(No.prototype,"_alignFlags",[p],(function(){return 0})),Ho=l(No.prototype,"_target",[p],(function(){return null})),Mo=l(No.prototype,"_left",[p],(function(){return 0})),zo=l(No.prototype,"_right",[p],(function(){return 0})),ko=l(No.prototype,"_top",[p],(function(){return 0})),Vo=l(No.prototype,"_bottom",[p],(function(){return 0})),Fo=l(No.prototype,"_horizontalCenter",[p],(function(){return 0})),Uo=l(No.prototype,"_verticalCenter",[p],(function(){return 0})),Go=l(No.prototype,"_isAbsLeft",[p],(function(){return!0})),Wo=l(No.prototype,"_isAbsRight",[p],(function(){return!0})),jo=l(No.prototype,"_isAbsTop",[p],(function(){return!0})),Zo=l(No.prototype,"_isAbsBottom",[p],(function(){return!0})),Xo=l(No.prototype,"_isAbsHorizontalCenter",[p],(function(){return!0})),Yo=l(No.prototype,"_isAbsVerticalCenter",[p],(function(){return!0})),Ko=l(No.prototype,"_originalWidth",[p],(function(){return 0})),qo=l(No.prototype,"_originalHeight",[p],(function(){return 0})),Qo=l(No.prototype,"_alignMode",[p],(function(){return er.ON_WINDOW_RESIZE})),Jo=l(No.prototype,"_lockFlags",[p,B],(function(){return 0})),Po=No))||Po)||Po)||Po);t({Widget:mr,WidgetComponent:mr}),_.internal.computeInverseTransForTarget=rr,_.internal.getReadonlyNodeSize=or,_.Widget=mr;var Cr,Sr=new e;!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(Cr||(Cr={})),i(Cr);var Er,Lr,Ar,Or,br,Dr,Ir,Rr,xr,wr,Pr,Nr,Br,Hr,Mr,zr,kr,Vr,Fr,Ur,Gr,Wr,jr,Zr,Xr=(sr=n("cc.PageViewIndicator"),ar=u(110),hr=o(K),cr=o(Cr),lr=o(b),sr(_r=ar(((yr=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).spacing=dr&&dr(),e._spriteFrame=pr&&pr(),e._direction=gr&&gr(),e._cellSize=fr&&fr(),e._layout=null,e._pageView=null,e._indicators=[],e}r(e,t);var i=e.prototype;return i.onLoad=function(){this._updateLayout()},i.setPageView=function(t){this._pageView=t,this._refresh()},i._updateLayout=function(){this._layout=this.getComponent(Fi),this._layout||(this._layout=this.addComponent(Fi));var t=this._layout;this.direction===Cr.HORIZONTAL?(t.type=Fi.Type.HORIZONTAL,t.spacingX=this.spacing):this.direction===Cr.VERTICAL&&(t.type=Fi.Type.VERTICAL,t.spacingY=this.spacing),t.resizeMode=Fi.ResizeMode.CONTAINER},i._createIndicator=function(){var t=new at;t.layer=this.node.layer;var e=t.addComponent(J);return e.spriteFrame=this.spriteFrame,e.sizeMode=J.SizeMode.CUSTOM,t.parent=this.node,t._uiProps.uiTransformComp.setContentSize(this._cellSize),t},i._changedState=function(){var t=this._indicators;if(0!==t.length&&this._pageView){var e=this._pageView.curPageIdx;if(!(e>=t.length)){for(var i=0;i<t.length;++i){var n=t[i];if(n._uiProps.uiComp){var o=n._uiProps.uiComp;Sr.set(o.color),Sr.a=127.5,o.color=Sr}}if(t[e]._uiProps.uiComp){var r=t[e]._uiProps.uiComp;Sr.set(r.color),Sr.a=255,r.color=Sr}}}},i._refresh=function(){if(this._pageView){var t=this._indicators,e=this._pageView.getPages();if(e.length!==t.length){var i=0;if(e.length>t.length)for(i=0;i<e.length;++i)t[i]||(t[i]=this._createIndicator());else for(i=t.length-e.length;i>0;--i){var n=t[i-1];this.node.removeChild(n),t.splice(i-1,1)}this._layout&&this._layout.enabledInHierarchy&&this._layout.updateLayout(),this._changedState()}}},h(e,[{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){this._spriteFrame!==t&&(this._spriteFrame=t)}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction!==t&&(this._direction=t)}},{key:"cellSize",get:function(){return this._cellSize},set:function(t){this._cellSize!==t&&(this._cellSize=t)}}]),e}(dt)).Direction=Cr,c((ur=yr).prototype,"spriteFrame",[hr],Object.getOwnPropertyDescriptor(ur.prototype,"spriteFrame"),ur.prototype),c(ur.prototype,"direction",[cr],Object.getOwnPropertyDescriptor(ur.prototype,"direction"),ur.prototype),c(ur.prototype,"cellSize",[lr],Object.getOwnPropertyDescriptor(ur.prototype,"cellSize"),ur.prototype),dr=l(ur.prototype,"spacing",[p],(function(){return 0})),pr=l(ur.prototype,"_spriteFrame",[p],(function(){return null})),gr=l(ur.prototype,"_direction",[p],(function(){return Cr.HORIZONTAL})),fr=l(ur.prototype,"_cellSize",[p],(function(){return new b(20,20)})),_r=ur))||_r)||_r);t({PageViewIndicator:Xr,PageViewIndicatorComponent:Xr}),_.PageViewIndicator=Xr;var Yr,Kr,qr,Qr=new I;!function(t){t[t.Unified=0]="Unified",t[t.Free=1]="Free"}(Yr||(Yr={})),i(Yr),function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(Kr||(Kr={})),i(Kr),function(t){t.PAGE_TURNING="page-turning"}(qr||(qr={}));var Jr=(Er=n("cc.PageView"),Lr=u(110),Ar=o(Yr),Or=o(Kr),br=o(Xr),Dr=o(_n),Ir=o(_n),Rr=o([ut]),xr=o([ut]),Er(wr=Lr(((Zr=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).autoPageTurningThreshold=Nr&&Nr(),e.horizontal=Br&&Br(),e.vertical=Hr&&Hr(),e.cancelInnerEvents=Mr&&Mr(),e.scrollEvents=zr&&zr(),e.pageTurningSpeed=kr&&kr(),e.pageEvents=Vr&&Vr(),e._sizeMode=Fr&&Fr(),e._direction=Ur&&Ur(),e._scrollThreshold=Gr&&Gr(),e._pageTurningEventTiming=Wr&&Wr(),e._indicator=jr&&jr(),e._curPageIdx=0,e._lastPageIdx=0,e._pages=[],e._initContentPos=new a,e._scrollCenterOffsetX=[],e._scrollCenterOffsetY=[],e._touchBeganPosition=new I,e._touchEndPosition=new I,e}r(e,t);var i=e.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.node.on(_t.SIZE_CHANGED,this._updateAllPagesSize,this),this.node.on(e.EventType.SCROLL_ENG_WITH_THRESHOLD,this._dispatchPageTurningEvent,this)},i.onDisable=function(){t.prototype.onDisable.call(this),this.node.off(_t.SIZE_CHANGED,this._updateAllPagesSize,this),this.node.off(e.EventType.SCROLL_ENG_WITH_THRESHOLD,this._dispatchPageTurningEvent,this)},i.onLoad=function(){this._initPages(),this.indicator&&this.indicator.setPageView(this)},i.getCurrentPageIndex=function(){return this._curPageIdx},i.setCurrentPageIndex=function(t){this.scrollToPage(t,1)},i.getPages=function(){return this._pages},i.addPage=function(t){t&&-1===this._pages.indexOf(t)&&this.content&&(t._uiProps.uiTransformComp?(this.content.addChild(t),this._pages.push(t),this._updatePageView()):w(4301))},i.insertPage=function(t,e){if(!(e<0)&&t&&-1===this._pages.indexOf(t)&&this.content)if(e>=this._pages.length)this.addPage(t);else{if(!t._uiProps.uiTransformComp)return void w(4301);this._pages.splice(e,0,t),this.content.insertChild(t,e),this._updatePageView()}},i.removePage=function(t){if(t&&this.content){var e=this._pages.indexOf(t);-1!==e?this.removePageAtIndex(e):H(4300,t.name)}},i.removePageAtIndex=function(t){var e=this._pages;if(!(t<0||t>=e.length)){var i=e[t];i&&this.content&&(this.content.removeChild(i),e.splice(t,1),this._updatePageView())}},i.removeAllPages=function(){if(this.content){for(var t=this._pages,e=0,i=t.length;e<i;e++)this.content.removeChild(t[e]);this._pages.length=0,this._updatePageView()}},i.scrollToPage=function(t,e){void 0===e&&(e=.3),t<0||t>=this._pages.length||(this._curPageIdx=t,this.scrollToOffset(this._moveOffsetValue(t),e,!0),this.indicator&&this.indicator._changedState())},i.getScrollEndedEventTiming=function(){return this.pageTurningEventTiming},i._updatePageView=function(){if(this.content){var t=this.content.getComponent(Fi);t&&t.enabled&&t.updateLayout();var e=this._pages.length;this._curPageIdx>=e&&(this._curPageIdx=0===e?0:e-1,this._lastPageIdx=this._curPageIdx);for(var i=this._initContentPos,n=0;n<e;++n){var o=this._pages[n].position;this.direction===Kr.Horizontal?this._scrollCenterOffsetX[n]=Math.abs(i.x+o.x):this._scrollCenterOffsetY[n]=Math.abs(i.y+o.y)}this.indicator&&this.indicator._refresh()}},i._updateAllPagesSize=function(){var t=this.view;if(this.content&&t&&this._sizeMode===Yr.Unified)for(var e=this._pages,i=t.contentSize,n=0,o=e.length;n<o;n++)e[n]._uiProps.uiTransformComp.setContentSize(i)},i._handleReleaseLogic=function(){this._autoScrollToPage(),this._scrolling&&(this._scrolling=!1,this._autoScrolling||this._dispatchEvent(e.EventType.SCROLL_ENDED))},i._onTouchBegan=function(e,i){e.touch.getUILocation(Qr),I.set(this._touchBeganPosition,Qr.x,Qr.y),t.prototype._onTouchBegan.call(this,e,i)},i._onTouchMoved=function(e,i){t.prototype._onTouchMoved.call(this,e,i)},i._onTouchEnded=function(e,i){e.touch.getUILocation(Qr),I.set(this._touchEndPosition,Qr.x,Qr.y),t.prototype._onTouchEnded.call(this,e,i)},i._onTouchCancelled=function(e,i){e.touch.getUILocation(Qr),I.set(this._touchEndPosition,Qr.x,Qr.y),t.prototype._onTouchCancelled.call(this,e,i)},i._onMouseWheel=function(){},i._syncScrollDirection=function(){this.horizontal=this.direction===Kr.Horizontal,this.vertical=this.direction===Kr.Vertical},i._syncSizeMode=function(){var t=this.view;if(this.content&&t){var e=this.content.getComponent(Fi);if(e){if(this._sizeMode===Yr.Free&&this._pages.length>0){var i=this._pages[0]._uiProps.uiTransformComp,n=this._pages[this._pages.length-1]._uiProps.uiTransformComp;this.direction===Kr.Horizontal?(e.paddingLeft=(t.width-i.width)/2,e.paddingRight=(t.width-n.width)/2):this.direction===Kr.Vertical&&(e.paddingTop=(t.height-i.height)/2,e.paddingBottom=(t.height-n.height)/2)}e.updateLayout()}}},i._initPages=function(){if(this.content){this._initContentPos=this.content.position;for(var t=this.content.children,e=0;e<t.length;++e){var i=t[e];this._pages.indexOf(i)>=0||this._pages.push(i)}this._syncScrollDirection(),this._syncSizeMode(),this._updatePageView()}},i._dispatchPageTurningEvent=function(){this._lastPageIdx!==this._curPageIdx&&(this._lastPageIdx=this._curPageIdx,ut.emitEvents(this.pageEvents,this,qr.PAGE_TURNING),this.node.emit(qr.PAGE_TURNING,this))},i._isQuicklyScrollable=function(t){if(this.direction===Kr.Horizontal){if(Math.abs(t.x)>this.autoPageTurningThreshold)return!0}else if(this.direction===Kr.Vertical&&Math.abs(t.y)>this.autoPageTurningThreshold)return!0;return!1},i._moveOffsetValue=function(t){var e=new I;if(this._sizeMode===Yr.Free)this.direction===Kr.Horizontal?e.x=this._scrollCenterOffsetX[t]:this.direction===Kr.Vertical&&(e.y=this._scrollCenterOffsetY[t]);else{var i=this.view;if(!i)return e;this.direction===Kr.Horizontal?e.x=t*i.width:this.direction===Kr.Vertical&&(e.y=t*i.height)}return e},i._getDragDirection=function(t){return this._direction===Kr.Horizontal?0===t.x?0:t.x>0?1:-1:0===t.y?0:t.y<0?1:-1},i._isScrollable=function(t,e,i){if(this._sizeMode===Yr.Free){var n=0,o=0;if(this.direction===Kr.Horizontal)return n=this._scrollCenterOffsetX[e],o=this._scrollCenterOffsetX[i],Math.abs(t.x)>=Math.abs(n-o)*this.scrollThreshold;if(this.direction===Kr.Vertical)return n=this._scrollCenterOffsetY[e],o=this._scrollCenterOffsetY[i],Math.abs(t.y)>=Math.abs(n-o)*this.scrollThreshold}else{var r=this.view;if(!r)return!1;if(this.direction===Kr.Horizontal)return Math.abs(t.x)>=r.width*this.scrollThreshold;if(this.direction===Kr.Vertical)return Math.abs(t.y)>=r.height*this.scrollThreshold}return!1},i._autoScrollToPage=function(){if(this._startBounceBackIfNeeded()){var t=this._getHowMuchOutOfBoundary();this._clampDelta(t),(t.x>0||t.y<0)&&(this._curPageIdx=0===this._pages.length?0:this._pages.length-1),(t.x<0||t.y>0)&&(this._curPageIdx=0),this.indicator&&this.indicator._changedState()}else{var e=new I;I.subtract(e,this._touchBeganPosition,this._touchEndPosition);var i=this._curPageIdx,n=i+this._getDragDirection(e),o=this.pageTurningSpeed*Math.abs(i-n);if(n<this._pages.length){if(this._isScrollable(e,i,n))return void this.scrollToPage(n,o);var r=this._calculateTouchMoveVelocity();if(this._isQuicklyScrollable(r))return void this.scrollToPage(n,o)}this.scrollToPage(i,o)}},h(e,[{key:"sizeMode",get:function(){return this._sizeMode},set:function(t){this._sizeMode!==t&&(this._sizeMode=t,this._syncSizeMode())}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction!==t&&(this._direction=t,this._syncScrollDirection())}},{key:"scrollThreshold",get:function(){return this._scrollThreshold},set:function(t){this._scrollThreshold!==t&&(this._scrollThreshold=t)}},{key:"pageTurningEventTiming",get:function(){return this._pageTurningEventTiming},set:function(t){this._pageTurningEventTiming!==t&&(this._pageTurningEventTiming=t)}},{key:"indicator",get:function(){return this._indicator},set:function(t){this._indicator!==t&&(this._indicator=t,this.indicator&&this.indicator.setPageView(this))}},{key:"curPageIdx",get:function(){return this._curPageIdx}},{key:"verticalScrollBar",get:function(){return t.prototype.verticalScrollBar},set:function(t){this.verticalScrollBar=t}},{key:"horizontalScrollBar",get:function(){return t.prototype.horizontalScrollBar},set:function(t){this.horizontalScrollBar=t}}]),e}(io)).SizeMode=Yr,Zr.Direction=Kr,Zr.EventType=vo(qr,Nn),c((Pr=Zr).prototype,"sizeMode",[Ar],Object.getOwnPropertyDescriptor(Pr.prototype,"sizeMode"),Pr.prototype),c(Pr.prototype,"direction",[Or],Object.getOwnPropertyDescriptor(Pr.prototype,"direction"),Pr.prototype),c(Pr.prototype,"indicator",[br],Object.getOwnPropertyDescriptor(Pr.prototype,"indicator"),Pr.prototype),Nr=l(Pr.prototype,"autoPageTurningThreshold",[p],(function(){return 100})),c(Pr.prototype,"verticalScrollBar",[Dr,M],Object.getOwnPropertyDescriptor(Pr.prototype,"verticalScrollBar"),Pr.prototype),c(Pr.prototype,"horizontalScrollBar",[Ir,M],Object.getOwnPropertyDescriptor(Pr.prototype,"horizontalScrollBar"),Pr.prototype),Br=l(Pr.prototype,"horizontal",[M,p],(function(){return!0})),Hr=l(Pr.prototype,"vertical",[M,p],(function(){return!0})),Mr=l(Pr.prototype,"cancelInnerEvents",[M,p],(function(){return!0})),zr=l(Pr.prototype,"scrollEvents",[Rr,p,M],(function(){return[]})),kr=l(Pr.prototype,"pageTurningSpeed",[p],(function(){return.3})),Vr=l(Pr.prototype,"pageEvents",[xr,p],(function(){return[]})),Fr=l(Pr.prototype,"_sizeMode",[p],(function(){return Yr.Unified})),Ur=l(Pr.prototype,"_direction",[p],(function(){return Kr.Horizontal})),Gr=l(Pr.prototype,"_scrollThreshold",[p],(function(){return.5})),Wr=l(Pr.prototype,"_pageTurningEventTiming",[p],(function(){return.1})),jr=l(Pr.prototype,"_indicator",[p],(function(){return null})),wr=Pr))||wr)||wr);t({PageView:Jr,PageViewComponent:Jr}),_.PageView=Jr;var $r=new a,ts=new I,es=new I,is=new I(1,1),ns=new I,os=new I;function rs(t,e){if(!e._hadAlignOnce){e.alignMode===er.ONCE&&(e._hadAlignOnce=!0);var i,n=e.target,o=es,r=is;n?rr(t,i=n,o,r):i=t.parent;var s=or(i),h=i instanceof ht||!i.getComponent(Y),c=h?ts:i.getComponent(Y).anchorPoint,l=h;t.getPosition($r);var _=t._uiProps.uiTransformComp,u=$r.x,d=$r.y,p=_.anchorPoint,g=t.getScale();if(e.alignFlags&ir.HORIZONTAL){var f=0,y=0,T=s.width;l?(f=E.left.x,y=E.right.x):y=(f=-c.x*T)+T,f+=e.isAbsoluteLeft?e.left:e.left*T,y-=e.isAbsoluteRight?e.right:e.right*T,n&&(f+=o.x,f*=r.x,y+=o.x,y*=r.x);var v=0,m=p.x,C=g.x;if(C<0&&(m=1-m,C=-C),e.isStretchWidth)v=y-f,0!==C&&(_.width=v/C),u=f+m*v;else{if(v=_.width*C,e.isAlignHorizontalCenter){var S=e.isAbsoluteHorizontalCenter?e.horizontalCenter:e.horizontalCenter*T,L=(.5-c.x)*s.width;n&&(S*=r.x,L+=o.x,L*=r.x),u=L+(m-.5)*v+S}else u=e.isAlignLeft?f+m*v:y+(m-1)*v;k(C,0,V)?v=_.width:v/=C}e._lastSize.width=v}if(e.alignFlags&ir.VERTICAL){var A=0,O=0,b=s.height;l?(O=E.bottom.y,A=E.top.y):A=(O=-c.y*b)+b,O+=e.isAbsoluteBottom?e.bottom:e.bottom*b,A-=e.isAbsoluteTop?e.top:e.top*b,n&&(O+=o.y,O*=r.y,A+=o.y,A*=r.y);var D=0,I=p.y,R=g.y;if(R<0&&(I=1-I,R=-R),e.isStretchHeight)D=A-O,0!==R&&(_.height=D/R),d=O+I*D;else{if(D=_.height*R,e.isAlignVerticalCenter){var x=e.isAbsoluteVerticalCenter?e.verticalCenter:e.verticalCenter*b,w=(.5-c.y)*s.height;n&&(x*=r.y,w+=o.y,w*=r.y),d=w+(I-.5)*D+x}else d=e.isAlignBottom?O+I*D:A+(I-1)*D;k(R,0,V)?D=_.height:D/=R}e._lastSize.height=D}t.setPosition(u,d,$r.z),a.set(e._lastPos,u,d,$r.z)}}function ss(t){var e=t.getComponent(mr);if(e&&e.enabled){if(!_.isValid(t,!0))return;cs.push(e)}for(var i,n=t.children,o=x(n);!(i=o()).done;){var r=i.value;r.active&&ss(r)}}function as(){var t=it.getScene();if(t){ls.isAligning=!0,ls._nodesOrderDirty&&(cs.length=0,ss(t),ls._nodesOrderDirty=!1);var e=null,i=ls._activeWidgetsIterator;for(i.i=0;i.i<cs.length;++i.i)(e=cs[i.i])._dirty&&(rs(e.node,e),e._dirty=!1);ls.isAligning=!1}}var hs,cs=[],ls=t("widgetManager",_._widgetManager={isAligning:!1,_nodesOrderDirty:!1,_activeWidgetsIterator:new z(cs),animationState:null,init:function(){it.on(nt.EVENT_AFTER_SCENE_LAUNCH,as),it.on(nt.EVENT_AFTER_UPDATE,as),Q.instance.on("design-resolution-changed",this.onResized,this);var t=this.onResized.bind(this);Q.instance.on("canvas-resize",t),C.on("window-resize",t)},add:function(){this._nodesOrderDirty=!0},remove:function(t){this._activeWidgetsIterator.remove(t)},onResized:function(){var t=it.getScene();t&&this.refreshWidgetOnResized(t)},refreshWidgetOnResized:function(t){var e=at.isNode(t)&&t.getComponent(mr);e&&e.enabled&&(e.alignMode===er.ON_WINDOW_RESIZE||e.alignMode===er.ALWAYS)&&e.setDirty();for(var i,n=t.children,o=x(n);!(i=o()).done;){var r=i.value;this.refreshWidgetOnResized(r)}},updateOffsetsToStayPut:function(t,e){function i(t,e){return Math.abs(t-e)>1e-10?e:t}var n=t.node,o=n.parent;if(o){var r=ns;r.set(0,0);var s=os;if(s.set(1,1),t.target&&rr(n,o=t.target,r,s),!e)return;var a=o._uiProps&&o._uiProps.uiTransformComp,h=a?a.anchorPoint:ts,c=n._uiProps.uiTransformComp,l=or(o),_=c.anchorPoint,u=n.getPosition(),d=ir,p=n.getScale(),g=0;if(e&d.LEFT){var f=-h.x*l.width;f+=r.x,f*=s.x,g=u.x-_.x*c.width*Math.abs(p.x)-f,t.isAbsoluteLeft||(g/=l.width),g/=s.x,t.left=i(t.left,g)}if(e&d.RIGHT){var y=(1-h.x)*l.width;y+=r.x,g=(y*=s.x)-(u.x+(1-_.x)*c.width*Math.abs(p.x)),t.isAbsoluteRight||(g/=l.width),g/=s.x,t.right=i(t.right,g)}if(e&d.TOP){var T=(1-h.y)*l.height;T+=r.y,g=(T*=s.y)-(u.y+(1-_.y)*c.height*Math.abs(p.y)),t.isAbsoluteTop||(g/=l.height),g/=s.y,t.top=i(t.top,g)}if(e&d.BOT){var v=-h.y*l.height;v+=r.y,v*=s.y,g=u.y-_.y*c.height*Math.abs(p.y)-v,t.isAbsoluteBottom||(g/=l.height),g/=s.y,t.bottom=i(t.bottom,g)}}},updateAlignment:function t(e){var i=e.parent;i&&at.isNode(i)&&t(i);var n=e.getComponent(mr);n&&i&&rs(e,n)},AlignMode:er,AlignFlags:ir});it.on(nt.EVENT_INIT,(function(){ls.init()}));var _s,us,ds,ps,gs,fs,ys,Ts,vs,ms,Cs,Ss,Es=n("cc.SafeArea")(hs=u(110)(hs=d(mr)(hs=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var i=e.prototype;return i.onEnable=function(){this.updateArea(),C.on("window-resize",this.updateArea,this),C.on("orientation-change",this.updateArea,this)},i.onDisable=function(){C.off("window-resize",this.updateArea,this),C.off("orientation-change",this.updateArea,this)},i.updateArea=function(){var t=this.node.getComponent(mr),e=this.node.getComponent(Y);if(t&&e){t.updateAlignment();var i=this.node.position.clone(),n=e.anchorPoint.clone();t.isAlignTop=t.isAlignBottom=t.isAlignLeft=t.isAlignRight=!0;var o=q.getVisibleSize(),r=o.width,s=o.height,a=v.getSafeAreaRect();t.top=s-a.y-a.height,t.bottom=a.y,t.left=a.x,t.right=r-a.x-a.width,t.updateAlignment();var h=this.node.position.clone(),c=n.x-(h.x-i.x)/e.width,l=n.y-(h.y-i.y)/e.height;e.setAnchorPoint(c,l),ls.add(t)}},e}(dt))||hs)||hs)||hs;t({SafeArea:Es,SafeAreaComponent:Es}),_.SafeArea=Es;var Ls,As=(_s=n("cc.UICoordinateTracker"),us=u(110),ds=o(at),ps=o(Lt),gs=o([ut]),_s(fs=us((ys=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).syncEvents=Ts&&Ts(),e._target=vs&&vs(),e._camera=ms&&ms(),e._useScale=Cs&&Cs(),e._distance=Ss&&Ss(),e._transformPos=new a,e._viewPos=new a,e._canMove=!0,e._lastWPos=new a,e._lastCameraPos=new a,e}r(e,t);var i=e.prototype;return i.onEnable=function(){this._checkCanMove()},i.update=function(){var t=this.node.worldPosition,e=this._camera;if(this._canMove&&e&&e.camera&&(!this._lastWPos.equals(t)||!this._lastCameraPos.equals(e.node.worldPosition))&&(this._lastWPos.set(t),this._lastCameraPos.set(e.node.worldPosition),e.camera.update(),e.convertToUINode(t,this._target,this._transformPos),this._useScale&&a.transformMat4(this._viewPos,this.node.worldPosition,e.camera.matView),this.syncEvents.length>0)){var i=this._distance/Math.abs(this._viewPos.z);ut.emitEvents(this.syncEvents,this._transformPos,i)}},i._checkCanMove=function(){this._canMove=!(!this._camera||!this._target)},h(e,[{key:"target",get:function(){return this._target},set:function(t){this._target!==t&&(this._target=t,this._checkCanMove())}},{key:"camera",get:function(){return this._camera},set:function(t){this._camera!==t&&(this._camera=t,this._checkCanMove())}},{key:"useScale",get:function(){return this._useScale},set:function(t){this._useScale!==t&&(this._useScale=t)}},{key:"distance",get:function(){return this._distance},set:function(t){this._distance!==t&&(this._distance=t)}}]),e}(dt),c(ys.prototype,"target",[ds],Object.getOwnPropertyDescriptor(ys.prototype,"target"),ys.prototype),c(ys.prototype,"camera",[ps],Object.getOwnPropertyDescriptor(ys.prototype,"camera"),ys.prototype),Ts=l(ys.prototype,"syncEvents",[gs,p],(function(){return[]})),vs=l(ys.prototype,"_target",[p],(function(){return null})),ms=l(ys.prototype,"_camera",[p],(function(){return null})),Cs=l(ys.prototype,"_useScale",[p],(function(){return!0})),Ss=l(ys.prototype,"_distance",[p],(function(){return 1})),fs=ys))||fs)||fs);t({UICoordinateTracker:As,UICoordinateTrackerComponent:As});var Os=[_t.TOUCH_START,_t.TOUCH_END,_t.TOUCH_MOVE,_t.MOUSE_DOWN,_t.MOUSE_MOVE,_t.MOUSE_UP,_t.MOUSE_ENTER,_t.MOUSE_LEAVE,_t.MOUSE_WHEEL];function bs(t){t.propagationStopped=!0}var Ds,Is,Rs,xs,ws=n("cc.BlockInputEvents")(Ls=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var i=e.prototype;return i.onEnable=function(){for(var t=0;t<Os.length;t++)this.node.on(Os[t],bs,this)},i.onDisable=function(){for(var t=0;t<Os.length;t++)this.node.off(Os[t],bs,this)},e}(dt))||Ls;t({BlockInputEvents:ws,BlockInputEventsComponent:ws});var Ps,Ns=t("SubContextView",n("cc.SubContextView")(Ds=u(110)(Ds=d(Y)((Is=function(t){function e(){var e;return(e=t.call(this)||this)._fps=Rs&&Rs(),e._sprite=void 0,e._imageAsset=void 0,e._texture=void 0,e._updatedTime=0,e._updateInterval=0,e._openDataContext=void 0,e._content=void 0,e._designResolutionSize=xs&&xs(),e._content=new at("content"),e._content.hideFlags|=U.Flags.DontSave|U.Flags.HideInHierarchy,e._sprite=null,e._imageAsset=new ct,e._openDataContext=null,e._updatedTime=performance.now(),e._texture=new lt,e}r(e,t);var i=e.prototype;return i.onLoad=function(){F.getOpenDataContext?(this._updateInterval=1e3/this._fps,this._openDataContext=F.getOpenDataContext(),this._initSharedCanvas(),this._initContentNode(),this._updateSubContextView(),this._updateContentLayer()):this.enabled=!1},i.onEnable=function(){this._registerNodeEvent()},i.onDisable=function(){this._unregisterNodeEvent()},i._initSharedCanvas=function(){if(this._openDataContext){var t=this._openDataContext.canvas,e=this._designResolutionSize.width,i=this._designResolutionSize.height,n=513;if(e<=n&&i<=n){var o=n/e,r=n/i,s=o<r?o:r;e*=s,i*=s}t.width=e,t.height=i}},i._initContentNode=function(){if(this._openDataContext){var t=this._openDataContext.canvas,e=this._imageAsset;if(e.reset(t),this._texture.image=e,this._texture.create(t.width,t.height),this._sprite=this._content.getComponent(J),this._sprite||(this._sprite=this._content.addComponent(J)),this._sprite.spriteFrame)this._sprite.spriteFrame.texture=this._texture;else{var i=new K;i.texture=this._texture,this._sprite.spriteFrame=i}this._content.parent=this.node}},i._updateSubContextView=function(){if(this._openDataContext){var t=this.node.getComponent(Y),e=this._content.getComponent(Y),i=t.width/e.width,n=t.height/e.height,o=i>n?n:i;e.width*=o,e.height*=o;var r=q.getViewportRect(),s=e.getBoundingBoxToWorld(),a=q.getVisibleSize(),h=C.devicePixelRatio,c=(r.width*(s.x/a.width)+r.x)/h,l=(r.height*(s.y/a.height)+r.y)/h,_=r.width*(s.width/a.width)/h,u=r.height*(s.height/a.height)/h;this._openDataContext.postMessage({fromEngine:!0,type:"engine",event:"viewport",x:c,y:l,width:_,height:u})}},i._updateSubContextTexture=function(){var t=this._imageAsset;if(t&&this._openDataContext&&!(t.width<=0||t.height<=0)){var e=this._openDataContext.canvas;t.reset(e),(e.width>t.width||e.height>t.height)&&this._texture.create(e.width,e.height),this._texture.uploadData(e)}},i._registerNodeEvent=function(){this.node.on(_t.TRANSFORM_CHANGED,this._updateSubContextView,this),this.node.on(_t.SIZE_CHANGED,this._updateSubContextView,this),this.node.on(_t.LAYER_CHANGED,this._updateContentLayer,this)},i._unregisterNodeEvent=function(){this.node.off(_t.TRANSFORM_CHANGED,this._updateSubContextView,this),this.node.off(_t.SIZE_CHANGED,this._updateSubContextView,this),this.node.off(_t.LAYER_CHANGED,this._updateContentLayer,this)},i._updateContentLayer=function(){this._content.layer=this.node.layer},i.update=function(t){void 0===t?this._updateSubContextTexture():performance.now()-this._updatedTime>=this._updateInterval&&(this._updatedTime+=this._updateInterval,this._updateSubContextTexture())},i.onDestroy=function(){this._content.destroy(),this._texture.destroy(),this._sprite&&this._sprite.destroy(),this._imageAsset.destroy(),this._openDataContext=null},h(e,[{key:"designResolutionSize",get:function(){return this._designResolutionSize},set:function(){}},{key:"fps",get:function(){return this._fps},set:function(t){this._fps!==t&&(this._fps=t,this._updateInterval=1e3/t)}}]),e}(dt),Rs=l(Is.prototype,"_fps",[p],(function(){return 60})),xs=l(Is.prototype,"_designResolutionSize",[p],(function(){return new b(640,960)})),Ds=Is))||Ds)||Ds)||Ds);_.SubContextView=Ns,G({ButtonComponent:{newName:"Button",since:"1.2.0",removed:!1},EditBoxComponent:{newName:"EditBox",since:"1.2.0",removed:!1},LayoutComponent:{newName:"Layout",since:"1.2.0",removed:!1},ProgressBarComponent:{newName:"ProgressBar",since:"1.2.0",removed:!1},ScrollViewComponent:{newName:"ScrollView",since:"1.2.0",removed:!1},ScrollBarComponent:{newName:"ScrollBar",since:"1.2.0",removed:!1},SliderComponent:{newName:"Slider",since:"1.2.0",removed:!1},ToggleComponent:{newName:"Toggle",since:"1.2.0",removed:!1},ToggleContainerComponent:{newName:"ToggleContainer",since:"1.2.0",removed:!1},WidgetComponent:{newName:"Widget",since:"1.2.0",removed:!1},PageViewComponent:{newName:"PageView",since:"1.2.0",removed:!1},PageViewIndicatorComponent:{newName:"PageViewIndicator",since:"1.2.0",removed:!1},SafeAreaComponent:{newName:"SafeArea",since:"1.2.0",removed:!1},UICoordinateTrackerComponent:{newName:"UICoordinateTracker",since:"1.2.0",removed:!1},BlockInputEventsComponent:{newName:"BlockInputEvents",since:"1.2.0",removed:!1}});var Bs=t("UIReorderComponent",n("cc.UIReorderComponent")(Ps=function(){H(1408,"UIReorderComponent")})||Ps);_.UIReorderComponent=Bs,_.ButtonComponent=ie,W(ie,"cc.ButtonComponent"),_.EditBoxComponent=Ai,W(Ai,"cc.EditBoxComponent"),_.LayoutComponent=Fi,W(Fi,"cc.LayoutComponent"),_.ProgressBarComponent=en,W(en,"cc.ProgressBarComponent"),_.ScrollViewComponent=io,W(io,"cc.ScrollViewComponent"),_.ScrollBarComponent=_n,W(_n,"cc.ScrollBarComponent"),_.SliderComponent=To,W(To,"cc.SliderComponent"),_.ToggleComponent=bo,W(bo,"cc.ToggleComponent"),_.ToggleContainerComponent=tr,W(tr,"cc.ToggleContainerComponent"),_.WidgetComponent=mr,W(mr,"cc.WidgetComponent"),_.PageViewComponent=Jr,W(Jr,"cc.PageViewComponent"),_.PageViewIndicatorComponent=Xr,W(Xr,"cc.PageViewIndicatorComponent"),_.SafeAreaComponent=Es,W(Es,"cc.SafeAreaComponent"),W(As,"cc.UICoordinateTrackerComponent"),_.BlockInputEventsComponent=ws,W(ws,"cc.BlockInputEventsComponent"),j(Q.prototype,"View.prototype",[{name:"isAntiAliasEnabled",suggest:"The API of Texture2d have been largely modified, no alternative"},{name:"enableAntiAlias",suggest:"The API of Texture2d have been largely modified, no alternative"}]),Z(Q.prototype,"View.prototype",[{name:"adjustViewportMeta"},{name:"enableAutoFullScreen",suggest:"use screen.requestFullScreen() instead."},{name:"isAutoFullScreenEnabled"},{name:"setCanvasSize",suggest:"setting size in CSS pixels is not recommended, please use screen.windowSize instead."},{name:"getCanvasSize",suggest:"please use screen.windowSize instead."},{name:"getFrameSize",suggest:"getting size in CSS pixels is not recommended, please use screen.windowSize instead."},{name:"setFrameSize",suggest:"setting size in CSS pixels is not recommended, please use screen.windowSize instead."},{name:"getDevicePixelRatio",suggest:"use screen.devicePixelRatio instead."},{name:"convertToLocationInView"},{name:"enableRetina"},{name:"isRetinaEnabled"},{name:"setRealPixelResolution"}])}}}));
